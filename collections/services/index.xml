<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Services - 合集 - LEON BLOG</title><link>https://blog.liangml.dpdns.org/collections/services/</link><description>运维小站，分享些技术经验。</description><generator>Hugo 0.156.0 &amp; FixIt v0.4.2</generator><language>zh-CN</language><lastBuildDate>Tue, 15 Oct 2024 19:25:44 +0800</lastBuildDate><atom:link href="https://blog.liangml.dpdns.org/collections/services/index.xml" rel="self" type="application/rss+xml"/><item><title>OpenvpnCommunity</title><link>https://blog.liangml.dpdns.org/posts/openvpncommunity/</link><pubDate>Tue, 15 Oct 2024 19:25:44 +0800</pubDate><guid>https://blog.liangml.dpdns.org/posts/openvpncommunity/</guid><category domain="https://blog.liangml.dpdns.org/categories/openvpn/">Openvpn</category><description>&lt;pre&gt;&lt;code&gt;port 2305
proto udp
dev tun
ca ca.crt
cert server.crt
key server.key
dh dh.pem
auth SHA512
tls-crypt tc.key
topology subnet
server 10.8.0.0 255.255.255.0
ifconfig-pool-persist ipp.txt
push &amp;#34;dhcp-option DNS 100.100.2.136&amp;#34;
push &amp;#34;dhcp-option DNS 100.100.2.138&amp;#34;

# 内网推送
push &amp;#34;route 172.16.0.0 255.255.0.0&amp;#34;
# 阿里内网推送
push &amp;#34;route 100.100.0.0 255.255.0.0&amp;#34;
push &amp;#34;route 100.103.0.0 255.255.0.0&amp;#34;
push &amp;#34;route 47.106.223.210 255.255.255.255&amp;#34;

keepalive 10 120
cipher AES-256-CBC
user nobody
group nobody
persist-key
persist-tun
verb 3
crl-verify crl.pem
explicit-exit-notify&lt;/code&gt;&lt;/pre&gt;</description></item><item><title>Nginx</title><link>https://blog.liangml.dpdns.org/posts/nginx/</link><pubDate>Tue, 15 Oct 2024 19:25:10 +0800</pubDate><guid>https://blog.liangml.dpdns.org/posts/nginx/</guid><category domain="https://blog.liangml.dpdns.org/categories/nginx/">Nginx</category><description>&lt;h2 class="heading-element" id="trust-proxy-ip"&gt;&lt;span&gt;trust proxy ip&lt;/span&gt;
 &lt;a href="#trust-proxy-ip" class="heading-mark"&gt;
 &lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"&gt;&lt;/path&gt;&lt;/svg&gt;
 &lt;/a&gt;
&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;set_real_ip_from 172.16.0.0/16;
real_ip_header X-Forwarded-For;
real_ip_recursive on;&lt;/code&gt;&lt;/pre&gt;&lt;h2 class="heading-element" id="请求方法限制"&gt;&lt;span&gt;请求方法限制&lt;/span&gt;
 &lt;a href="#%e8%af%b7%e6%b1%82%e6%96%b9%e6%b3%95%e9%99%90%e5%88%b6" class="heading-mark"&gt;
 &lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"&gt;&lt;/path&gt;&lt;/svg&gt;
 &lt;/a&gt;
&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;if ($request_method !~ ^(GET|HEAD|POST)$ ) {
 return 501;
}&lt;/code&gt;&lt;/pre&gt;&lt;h2 class="heading-element" id="try_files"&gt;&lt;span&gt;try_files&lt;/span&gt;
 &lt;a href="#try_files" class="heading-mark"&gt;
 &lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"&gt;&lt;/path&gt;&lt;/svg&gt;
 &lt;/a&gt;
&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;location / {
 try_files $uri $uri/ /index.html;
}&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;next.js&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;location / {
 try_files $uri $uri.html $uri/ /index.html;
 }&lt;/code&gt;&lt;/pre&gt;&lt;h2 class="heading-element" id="443-force-ssl"&gt;&lt;span&gt;443 force ssl&lt;/span&gt;
 &lt;a href="#443-force-ssl" class="heading-mark"&gt;
 &lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"&gt;&lt;/path&gt;&lt;/svg&gt;
 &lt;/a&gt;
&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;if ($ssl_protocol = &amp;#34;&amp;#34;) { return 302 https://$host$request_uri; }
# 302
if ($server_port !~ 443) { rewrite ^(.*)$ https://$host$1 redirect; }
# 301
if ($server_port !~ 443) { rewrite ^(.*)$ https://$host$1 permanent; }&lt;/code&gt;&lt;/pre&gt;&lt;h2 class="heading-element" id="499"&gt;&lt;span&gt;499&lt;/span&gt;
 &lt;a href="#499" class="heading-mark"&gt;
 &lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"&gt;&lt;/path&gt;&lt;/svg&gt;
 &lt;/a&gt;
&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;proxy_ignore_client_abort on;
# 确定在客户端关闭连接时是否应关闭与代理服务器的连接，而不在等待响应
proxy_read_timeout 600;
proxy_send_timeout 600;
# 如果超时(默认60s)，Nginx 会主动断开连接，记录504&lt;/code&gt;&lt;/pre&gt;&lt;h2 class="heading-element" id="log-format"&gt;&lt;span&gt;log format&lt;/span&gt;
 &lt;a href="#log-format" class="heading-mark"&gt;
 &lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"&gt;&lt;/path&gt;&lt;/svg&gt;
 &lt;/a&gt;
&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;log_format main escape=json &amp;#39;{ &amp;#34;time_local&amp;#34;: &amp;#34;$time_local&amp;#34;, &amp;#39;
 &amp;#39;&amp;#34;remote_user&amp;#34;: &amp;#34;$remote_user&amp;#34;, &amp;#39;
 &amp;#39;&amp;#34;remote_addr&amp;#34;: &amp;#34;$remote_addr&amp;#34;, &amp;#39;
 &amp;#39;&amp;#34;http_referer&amp;#34;: &amp;#34;$http_referer&amp;#34;, &amp;#39;
 &amp;#39;&amp;#34;request&amp;#34;: &amp;#34;$request&amp;#34;, &amp;#39;
 &amp;#39;&amp;#34;method&amp;#34;: &amp;#34;$request_method&amp;#34;, &amp;#39;
 &amp;#39;&amp;#34;url_path&amp;#34;: &amp;#34;$request_uri&amp;#34;, &amp;#39;
 &amp;#39;&amp;#34;request_body&amp;#34;: &amp;#34;$request_body&amp;#34;, &amp;#39;
 &amp;#39;&amp;#34;status&amp;#34;: $status, &amp;#39;
 &amp;#39;&amp;#34;level&amp;#34;: &amp;#34;$level&amp;#34;,&amp;#39;
 &amp;#39;&amp;#34;body_bytes_sent&amp;#34;: $body_bytes_sent, &amp;#39;
 &amp;#39;&amp;#34;http_user_agent&amp;#34;: &amp;#34;$http_user_agent&amp;#34;, &amp;#39;
 &amp;#39;&amp;#34;http_host&amp;#34;: &amp;#34;$http_host&amp;#34;, &amp;#39;
 &amp;#39;&amp;#34;http_requestid&amp;#34;: &amp;#34;$http_requestid&amp;#34;, &amp;#39;
 &amp;#39;&amp;#34;http_authorization&amp;#34;: &amp;#34;$http_authorization&amp;#34;, &amp;#39;
 &amp;#39;&amp;#34;business&amp;#34;: &amp;#34;ngx_access-$host&amp;#34;, &amp;#39;
 &amp;#39;&amp;#34;http_x_forwarded_for&amp;#34;: &amp;#34;$http_x_forwarded_for&amp;#34;, &amp;#39;
 &amp;#39;&amp;#34;upstream_addr&amp;#34;: &amp;#34;$upstream_addr&amp;#34;,&amp;#39;
 &amp;#39;&amp;#34;trace_id&amp;#34;: &amp;#34;$trace_id&amp;#34;,&amp;#39;
 &amp;#39;&amp;#34;upstream_response_time&amp;#34;: &amp;#34;$upstream_response_timer&amp;#34;,&amp;#39;
 &amp;#39;&amp;#34;ssl_protocol&amp;#34;: &amp;#34;$ssl_protocol&amp;#34;,&amp;#39;
 &amp;#39;&amp;#34;request_time&amp;#34;: $request_time&amp;#39;
 &amp;#39; }&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;h2 class="heading-element" id="跨域"&gt;&lt;span&gt;跨域&lt;/span&gt;
 &lt;a href="#%e8%b7%a8%e5%9f%9f" class="heading-mark"&gt;
 &lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"&gt;&lt;/path&gt;&lt;/svg&gt;
 &lt;/a&gt;
&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;add_header Access-Control-Allow-Origin *;
add_header Access-Control-Allow-Methods *;
add_header Access-Control-Allow-Credentials true;&lt;/code&gt;&lt;/pre&gt;&lt;h2 class="heading-element" id="上传文件"&gt;&lt;span&gt;上传文件&lt;/span&gt;
 &lt;a href="#%e4%b8%8a%e4%bc%a0%e6%96%87%e4%bb%b6" class="heading-mark"&gt;
 &lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"&gt;&lt;/path&gt;&lt;/svg&gt;
 &lt;/a&gt;
&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;# nginx
client_max_body_size 1024m;&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;# php
file_uploads on 是否允许通过HTTP上传文件的开关。
默认为ON即是开upload_tmp_dir – 文件上传至服务器上存储临时文件的地方，如果没指定就会用系统默认的临时文件夹
upload_max_filesize 8m 望文生意，即允许上传文件大小的最大值。默认为2M
post_max_size 8m 指通过表单POST给PHP的所能接收的最大值，包括表单里的所有值。默认为8M
# 针对网络不好配置
max_execution_time 600 每个PHP页面运行的最大时间值(秒)，默认30秒
max_input_time 600 每个PHP页面接收数据所需的最大时间，默认60秒
memory_limit 8m 每个PHP页面所吃掉的最大内存，默认8M&lt;/code&gt;&lt;/pre&gt;&lt;h2 class="heading-element" id="proxy"&gt;&lt;span&gt;proxy&lt;/span&gt;
 &lt;a href="#proxy" class="heading-mark"&gt;
 &lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"&gt;&lt;/path&gt;&lt;/svg&gt;
 &lt;/a&gt;
&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;location ~ .*\.(js|css)?$ {
	expires 12h;
	proxy_pass http://xxx;
}
location ~ .*\.(gif|jpg|jpeg|png|bmp|swf)?$ {
	expires 12h;
	proxy_pass http://xxx;
}&lt;/code&gt;&lt;/pre&gt;&lt;h2 class="heading-element" id="exsample"&gt;&lt;span&gt;exsample&lt;/span&gt;
 &lt;a href="#exsample" class="heading-mark"&gt;
 &lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"&gt;&lt;/path&gt;&lt;/svg&gt;
 &lt;/a&gt;
&lt;/h2&gt;&lt;h3 class="heading-element" id="http"&gt;&lt;span&gt;http&lt;/span&gt;
 &lt;a href="#http" class="heading-mark"&gt;
 &lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"&gt;&lt;/path&gt;&lt;/svg&gt;
 &lt;/a&gt;
&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;upstream xxx.cn {
	server 10.x:3000 weight=10 max_fails=3 fail_timeout=3s;
	server 10.x:3000 weight=10 max_fails=3 fail_timeout=3s;

 	check interval=1000 rise=2 fall=3 timeout=5000 type=http default_down=false;
 	check_http_send &amp;#34;GET /ping HTTP/1.0\\r\\n\\r\\n&amp;#34;;
 	check_http_expect_alive http_2xx http_3xx;
}

server {
	listen	80;
	server_name xxx.cn;
	index index.html index.htm;
	access_log /var/log/nginx/xxx.cn.access.log main;
	error_log /var/log/nginx/xxx.cn.error.log warn;

	location ~ ^/NginxStatus/ {
			stub_status on;
			access_log on;
		}
	location / {
		proxy_redirect off ;
		proxy_set_header Host $host;
		proxy_set_header X-Real-IP $remote_addr;
		proxy_set_header REMOTE-HOST $remote_addr;
		proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
		proxy_connect_timeout 600;
		proxy_send_timeout 600;
		proxy_read_timeout 600;
		proxy_ignore_client_abort on;
		proxy_buffer_size 1600k;
		proxy_buffers 4 3200k;
		proxy_busy_buffers_size 6400k;
		proxy_temp_file_write_size 6400k;
		proxy_max_temp_file_size 128m;
		proxy_next_upstream error timeout invalid_header http_500 http_503 http_404;
		proxy_pass	http://xxx.cn;
	}
}&lt;/code&gt;&lt;/pre&gt;&lt;h3 class="heading-element" id="php"&gt;&lt;span&gt;php&lt;/span&gt;
 &lt;a href="#php" class="heading-mark"&gt;
 &lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"&gt;&lt;/path&gt;&lt;/svg&gt;
 &lt;/a&gt;
&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;listen 80;
listen [::]:80;
listen 443 ssl http2;
listen [::]:443 ssl http2;
ssl_certificate /usr/local/openresty/nginx/conf/ssl/xxx.com.pem;
ssl_certificate_key /usr/local/openresty/nginx/conf/ssl/xxx.com.key;
ssl_protocols TLSv1.2 TLSv1.3;
ssl_ecdh_curve X25519:prime256v1:secp384r1:secp521r1;
ssl_ciphers ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256;
ssl_conf_command Ciphersuites TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256;
ssl_conf_command Options PrioritizeChaCha;
ssl_prefer_server_ciphers on;
ssl_session_timeout 10m;
ssl_session_cache shared:SSL:10m;
ssl_buffer_size 2k;
add_header Strict-Transport-Security max-age=15768000;
ssl_stapling on;
ssl_stapling_verify on;
server_name xxx;
access_log /var/log/xxx.log combined;
index index.html index.htm index.php;
root xxx_path;

if ($ssl_protocol = &amp;#34;&amp;#34;) { return 302 https://$host$request_uri; }
location ~ [^/]\\.php(/|$) {
 #fastcgi_pass remote_php_ip:9000;
 fastcgi_pass unix:/dev/shm/php-cgi.sock;
 fastcgi_index index.php;
 include fastcgi.conf;
}
location ~ .*\\.(gif|jpg|jpeg|png|bmp|swf|flv|mp4|ico)$ {
 expires 30d;
 access_log off;
}
location ~ .*\\.(js|css)?$ {
 expires 7d;
 access_log off;
}
location ~ /(\\.user\\.ini|\\.ht|\\.git|\\.svn|\\.project|LICENSE|README\\.md|\\.env) {
 deny all;
}
location /.well-known {
 allow all;
}&lt;/code&gt;&lt;/pre&gt;&lt;h2 class="heading-element" id="default_server"&gt;&lt;span&gt;default_server&lt;/span&gt;
 &lt;a href="#default_server" class="heading-mark"&gt;
 &lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"&gt;&lt;/path&gt;&lt;/svg&gt;
 &lt;/a&gt;
&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;# 手动生成本地ssl公私钥
openssl req -x509 -nodes -days 3650 -newkey rsa:2048 -keyout /etc/nginx/ssl/nginx.key -out /etc/nginx/ssl/nginx.crt

# 增加default_server
cat &amp;lt;&amp;lt; &amp;#39;EOF&amp;#39; &amp;gt; /etc/nginx/sites-available/000_default
server {
 listen 80 default_server;
 listen 443 ssl default_server;
 ssl_certificate /etc/nginx/ssl/nginx.crt;
 ssl_certificate_key /etc/nginx/ssl/nginx.key;
 server_name _;
 return 444;
 access_log /var/log/nginx/000_default.access.log;
 error_log /var/log/nginx/000_default.error.log;
} 
EOF
# reload nginx
nginx -t
nginx -s reload

# 查看日志，检查其他域名是否正常
tailf /var/log/nginx/000_default.access.log&lt;/code&gt;&lt;/pre&gt;&lt;h2 class="heading-element" id="nginx-warn-variables_hash"&gt;&lt;span&gt;nginx warn variables_hash&lt;/span&gt;
 &lt;a href="#nginx-warn-variables_hash" class="heading-mark"&gt;
 &lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"&gt;&lt;/path&gt;&lt;/svg&gt;
 &lt;/a&gt;
&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;nginx: [warn] could not build optimal variables_hash, you should increase either variables_hash_max_size: 1024 or
variables_hash_bucket_size: 64; ignoring variables_hash_bucket_size&lt;/p&gt;</description></item><item><title>Minio</title><link>https://blog.liangml.dpdns.org/posts/minio/</link><pubDate>Tue, 15 Oct 2024 19:24:41 +0800</pubDate><guid>https://blog.liangml.dpdns.org/posts/minio/</guid><category domain="https://blog.liangml.dpdns.org/categories/minio/">Minio</category><description>&lt;p&gt;集群版条件&lt;/p&gt;
&lt;div class="alert alert-note"&gt;&lt;p class="alert-title"&gt;&lt;svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16"&gt;&lt;path d="M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z"/&gt;&lt;/svg&gt;注意&lt;/p&gt;&lt;ul&gt;
&lt;li&gt;单独无数据磁盘使用&lt;/li&gt;
&lt;li&gt;minio节点的时间不能超过3s&lt;/li&gt;
&lt;/ul&gt;&lt;/div&gt;&lt;h2 class="heading-element" id="nginx-配置"&gt;&lt;span&gt;nginx 配置&lt;/span&gt;
 &lt;a href="#nginx-%e9%85%8d%e7%bd%ae" class="heading-mark"&gt;
 &lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"&gt;&lt;/path&gt;&lt;/svg&gt;
 &lt;/a&gt;
&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;upstream xxx.com {
 least_conn;
 server 127.0.0.1:9000;
}
upstream xxx.com-console {
 least_conn;
 server 127.0.0.1:9001;
}

server {
 listen 80;
 listen [::]:80;
 server_name xxx.com;

 access_log /var/log/nginx/xxx.com.access.log main;
 error_log /var/log/nginx/xxx.com.error.log warn;
 # Allow special characters in headers
 ignore_invalid_headers off;
 # Allow any size file to be uploaded.
 # Set to a value such as 1000m; to restrict file size to a specific value
 client_max_body_size 0;
 # Disable buffering
 proxy_buffering off;
 proxy_request_buffering off;

 location / {
 proxy_set_header Host $http_host;
 proxy_set_header X-Real-IP $remote_addr;
 proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
 proxy_set_header X-Forwarded-Proto $scheme;

 proxy_connect_timeout 300;
 # Default is HTTP/1, keepalive is only enabled in HTTP/1.1
 proxy_http_version 1.1;
 proxy_set_header Connection &amp;#34;&amp;#34;;
 chunked_transfer_encoding off;

 proxy_pass &amp;lt;http://xxx.com&amp;gt;; # This uses the upstream directive definition to load balance
 }

 location /minio {
 proxy_set_header Host $http_host;
 proxy_set_header X-Real-IP $remote_addr;
 proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
 proxy_set_header X-Forwarded-Proto $scheme;
 proxy_set_header X-NginX-Proxy true;

 # This is necessary to pass the correct IP to be hashed
 # real_ip_header X-Real-IP;

 proxy_connect_timeout 300;

 # To support websockets in MinIO versions released after January 2023
 proxy_http_version 1.1;
 proxy_set_header Upgrade $http_upgrade;
 proxy_set_header Connection &amp;#34;upgrade&amp;#34;;

 chunked_transfer_encoding off;

 proxy_pass &amp;lt;http://xxx.com-console&amp;gt;; # This uses the upstream directive definition to load balance and assumes a static Console port of 9001
 }
}&lt;/code&gt;&lt;/pre&gt;&lt;h2 class="heading-element" id="minio-配置"&gt;&lt;span&gt;minio 配置&lt;/span&gt;
 &lt;a href="#minio-%e9%85%8d%e7%bd%ae" class="heading-mark"&gt;
 &lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"&gt;&lt;/path&gt;&lt;/svg&gt;
 &lt;/a&gt;
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;useradd minio -s /sbin/nologin&lt;/li&gt;
&lt;li&gt;/etc/default/minio&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;MINIO_VOLUMES=&amp;#34;&amp;lt;http://192.168.1.141/data/minio&amp;gt; &amp;lt;http://192.168.1.140/data/minio&amp;gt;&amp;#34;
MINIO_OPTS=&amp;#34;--console-address :9001 --address :9000&amp;#34;
MINIO_ROOT_USER=admin
MINIO_ROOT_PASSWORD=xxx
# MINIO_SERVER_URL=&amp;#34;&amp;lt;https://minio.example.net:9000&amp;gt;&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;/usr/lib/systemd/system/minio.service&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;[Unit]
Description=MinIO
Documentation=https://min.io/docs/minio/linux/index.html
Wants=network-online.target
After=network-online.target
AssertFileIsExecutable=/usr/local/bin/minio

[Service]
WorkingDirectory=/usr/local

User=minio
Group=minio
ProtectProc=invisible

EnvironmentFile=-/etc/default/minio
ExecStartPre=/bin/bash -c &amp;#34;if [ -z \\&amp;#34;${MINIO_VOLUMES}\\&amp;#34; ]; then echo \\&amp;#34;Variable MINIO_VOLUMES not set in /etc/default/minio\\&amp;#34;; exit 1; fi&amp;#34;
ExecStart=/usr/local/bin/minio server $MINIO_OPTS $MINIO_VOLUMES

# MinIO RELEASE.2023-05-04T21-44-30Z adds support for Type=notify (&amp;lt;https://www.freedesktop.org/software/systemd/man/systemd.service.html#Type=&amp;gt;)
# This may improve systemctl setups where other services use `After=minio.server`
# Uncomment the line to enable the functionality
# Type=notify

# Let systemd restart this service always
Restart=always

# Specifies the maximum file descriptor number that can be opened by this process
LimitNOFILE=65536

# Specifies the maximum number of threads this process can create
TasksMax=infinity

# Disable timeout logic and wait until process is stopped
TimeoutStopSec=infinity
SendSIGKILL=no

[Install]
WantedBy=multi-user.target

# Built for ${project.name}-${project.version} (${project.name})&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;开启自启动&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;# 创建minio目录（一个盘对应一个目录即可）
mkdir /data/minio
chown -R minio.minio /data/minio
systemctl enable minio
systemctl start minio&lt;/code&gt;&lt;/pre&gt;</description></item><item><title>Kibana</title><link>https://blog.liangml.dpdns.org/posts/kibana/</link><pubDate>Tue, 15 Oct 2024 15:08:58 +0800</pubDate><guid>https://blog.liangml.dpdns.org/posts/kibana/</guid><category domain="https://blog.liangml.dpdns.org/categories/kibana/">Kibana</category><description>&lt;ul&gt;
&lt;li&gt;kibana无法新建索引模式，F12 &amp;ldquo;403&amp;rdquo;: 权限问题&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;PUT .kibana/_settings
{
 &amp;#34;index&amp;#34;: {
 &amp;#34;blocks&amp;#34;: {
 &amp;#34;read_only_allow_delete&amp;#34;: false
 }
 }
}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;kibana磁盘满之后无法写入索引&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;PUT _settings
{
 &amp;#34;index&amp;#34;: {
 &amp;#34;blocks&amp;#34;: {
 &amp;#34;read_only_allow_delete&amp;#34;: &amp;#34;false&amp;#34;
 }
 }
}&lt;/code&gt;&lt;/pre&gt;</description></item><item><title>Kafka</title><link>https://blog.liangml.dpdns.org/posts/kafka/</link><pubDate>Tue, 15 Oct 2024 11:25:28 +0800</pubDate><guid>https://blog.liangml.dpdns.org/posts/kafka/</guid><category domain="https://blog.liangml.dpdns.org/categories/kafka/">Kafka</category><description>&lt;ul&gt;
&lt;li&gt;查看topic&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;bin/kafka-topics.sh --list --bootstrap-server 127.0.0.1:9092&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;查看某个topic信息&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;bin/kafka-topics.sh --bootstrap-server 127.0.0.1:9092 --describe TOPICNAME&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;查看所有消费组&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;bin/kafka-consumer-groups.sh --bootstrap-server 127.0.0.1:9092 --describe --group --all-groups&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;消费消息&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;bin/kafka-consumer-groups.sh --zookeeper 127.0.0.1:2181 --topic TOPICNAME&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;查看topic内容&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;bin/kafka-console-consumer.sh --bootstrap-server 127.0.0.1:9092 --from-beginning --topic TOPICNAME &lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;创建topic&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;bin/kafka-topics.sh --create --bootstrap-server 127.0.0.1:9092 --partitions 1 --replication-factor 1 --topic TOPICNAME &lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;删除topic&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;bin/kafka-topics.sh --delete --bootstrap-server 127.0.0.1:9092 --topic TOPICNAME&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;bin/kafka-topics.sh --zookeeper 127.0.0.1:2181 --list
bin/kafka-topics.sh --zookeeper 127.0.0.1:2181 --describe --topic TOPICNAME
bin/kafka-consumer-groups.sh --bootstrap-server 127.0.0.1:9092 --list
bin/kafka-consumer-groups.sh --bootstrap-server 127.0.0.1:9092 --describe --group GROUPNAME
bin/kafka-consumer-groups.sh --zookeeper 127.0.0.1:2181 --delete --group GROUPNAME
bin/kafka-console-consumer.sh --bootstrap-server localhost:9092 --from-beginning --topic TOPICNAME&lt;/code&gt;&lt;/pre&gt;</description></item><item><title>Gitlab</title><link>https://blog.liangml.dpdns.org/posts/gitlab/</link><pubDate>Mon, 14 Oct 2024 19:39:59 +0800</pubDate><guid>https://blog.liangml.dpdns.org/posts/gitlab/</guid><category domain="https://blog.liangml.dpdns.org/categories/gitlab/">Gitlab</category><description>&lt;h2 class="heading-element" id="git-lfs-问题"&gt;&lt;span&gt;git lfs 问题&lt;/span&gt;
 &lt;a href="#git-lfs-%e9%97%ae%e9%a2%98" class="heading-mark"&gt;
 &lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"&gt;&lt;/path&gt;&lt;/svg&gt;
 &lt;/a&gt;
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;客户端配置：&lt;code&gt;git config --system http.sslverify false&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;参考连接：https://blog.csdn.net/root_miss/article/details/81450687&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 class="heading-element" id="gitlab邮箱配置"&gt;&lt;span&gt;gitlab邮箱配置&lt;/span&gt;
 &lt;a href="#gitlab%e9%82%ae%e7%ae%b1%e9%85%8d%e7%bd%ae" class="heading-mark"&gt;
 &lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"&gt;&lt;/path&gt;&lt;/svg&gt;
 &lt;/a&gt;
&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;gitlab_rails[&amp;#39;smtp_enable&amp;#39;] = true
gitlab_rails[&amp;#39;smtp_address&amp;#39;] = &amp;#34;smtp.exmail.qq.com&amp;#34;
gitlab_rails[&amp;#39;smtp_port&amp;#39;] = 25
gitlab_rails[&amp;#39;smtp_user_name&amp;#39;] = &amp;#34;gitlab@xxx.cn&amp;#34;
gitlab_rails[&amp;#39;smtp_password&amp;#39;] = &amp;#34;xxx&amp;#34;
gitlab_rails[&amp;#39;smtp_domain&amp;#39;] = &amp;#34;smtp.exmail.qq.com&amp;#34;
gitlab_rails[&amp;#39;smtp_authentication&amp;#39;] = &amp;#34;login&amp;#34;
gitlab_rails[&amp;#39;smtp_ssl&amp;#39;] = false
gitlab_rails[&amp;#39;smtp_enable_starttls_auto&amp;#39;] = true
gitlab_rails[&amp;#39;gitlab_email_from&amp;#39;] = &amp;#34;gitlab@xxx.cn&amp;#34;
user[&amp;#34;git_user_email&amp;#34;] = &amp;#34;gitlab@xxx.cn&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;h2 class="heading-element" id="gitlab迁移"&gt;&lt;span&gt;gitlab迁移&lt;/span&gt;
 &lt;a href="#gitlab%e8%bf%81%e7%a7%bb" class="heading-mark"&gt;
 &lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"&gt;&lt;/path&gt;&lt;/svg&gt;
 &lt;/a&gt;
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;gitlab备份&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;gitlab-rake gitlab:backup:create&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;gitlab 定制相关数据服务&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;# 停止相关数据连接服务
gitlab-ctl stop unicorn
gitlab-ctl stop sidekiq
# 从1393513186编号备份中恢复
gitlab-rake gitlab:backup:restore BACKUP=1393513186
# 启动Gitlab
gitlab-ctl start&lt;/code&gt;&lt;/pre&gt;&lt;h2 class="heading-element" id="submodule"&gt;&lt;span&gt;submodule&lt;/span&gt;
 &lt;a href="#submodule" class="heading-mark"&gt;
 &lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"&gt;&lt;/path&gt;&lt;/svg&gt;
 &lt;/a&gt;
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;add submodule to project&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;git submodule add https://github.com/yyy/xxx.git DESTPATH&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;list submodule&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;git submodule&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;delete submodule&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;git submodule deinit&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;pull submodule: when git clone add parms &amp;ndash;recursive&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;git clone https://github.com/xxx.git --recursive&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;if you forget add &amp;ndash;recursive
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;git submodule update --init&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;git submodule update --init --recursive&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;update submodule
&lt;code&gt;git submodule update --remote&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;change branch
&lt;code&gt;git config submodule.xxx.branch dev&lt;/code&gt;
or &lt;code&gt;git config -f .gitmodules submodule.xxx.branch dev&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 class="heading-element" id="gitconfig-常用配置"&gt;&lt;span&gt;gitconfig 常用配置&lt;/span&gt;
 &lt;a href="#gitconfig-%e5%b8%b8%e7%94%a8%e9%85%8d%e7%bd%ae" class="heading-mark"&gt;
 &lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"&gt;&lt;/path&gt;&lt;/svg&gt;
 &lt;/a&gt;
&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;[alias]
	ch = checkou
	st = status
	staust = &amp;#39;gitst&amp;#39;
	cf = config
	ck = checkout
	ft = fetch
	fh = fetch
	br = branch
	brv = branch --v
	geturl = config --get remote.origin.url
	bs = bisect
	lg = log --graph --decorate --oneline --all
	cfg = config --global
	cfga = config --global alias.
	pull = pl
	pl = pull --rebase
	cm = commit -c HEAD
	ps = push
	lsr = ls-remote --heads
	udc = reset HEAD~
	ftg = fetch --tags
	am = commit -amend
	cmd = commit --amend
	rsh = reset HEAD~
	cmi = commit --interactive -c HEAD --reset-author
	i = --interactive
	rss = reset --soft
	rmc = rm --cached
	cp = cherry-pick
	cpx = cherry-pick -x
	bl = blame
	gk = gitk
	ltn = ls-tree -r HEAD~ --name-only
	lt = ls-tree -r HEAD~ --name-only
	ltng = ls-tree -r HEAD~ --name-only |grep
	lgd = log -p --full-diff
	bcm = &amp;#34;branch -a --contains &amp;#34;
	brc = branch -a --contains
	tagc = tag --contains&lt;/code&gt;&lt;/pre&gt;</description></item><item><title>Apisix</title><link>https://blog.liangml.dpdns.org/posts/apisix/</link><pubDate>Sat, 12 Oct 2024 15:58:53 +0800</pubDate><guid>https://blog.liangml.dpdns.org/posts/apisix/</guid><category domain="https://blog.liangml.dpdns.org/categories/apisix/">Apisix</category><description>&lt;h1 class="heading-element" id="nginx-proxy_pass---问题"&gt;&lt;span&gt;Nginx proxy_pass + / 问题:&lt;/span&gt;
 &lt;a href="#nginx-proxy_pass---%e9%97%ae%e9%a2%98" class="heading-mark"&gt;
 &lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"&gt;&lt;/path&gt;&lt;/svg&gt;
 &lt;/a&gt;
&lt;/h1&gt;&lt;pre&gt;&lt;code&gt;location /api {
	proxy_pass http://api_proxy/;
}
# 访问: http://api.xxx.com/api/admin;
# 转发效果：http://api_proxy/admin;&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;
&lt;p&gt;由于Apisix 使用的是radixtree 的写法, 导致只支持匹配规则(Full match,Prefix matching) , 并且不会去掉匹配的路径, 这个时候,
为了去掉上面的 /api , 需要使用到插件：proxy-rewrite&lt;br&gt;
Apisix-Router：https://apisix.apache.org/zh/docs/apisix/terminology/router&lt;br&gt;
Proxy-rewrite：https://apisix.apache.org/zh/docs/apisix/plugins/proxy-rewrite&lt;br&gt;
ngx_http_rewirte_module：https://nginx.org/en/docs/http/ngx_http_rewrite_module.html&lt;br&gt;
ngx_http_proxy_module：https://nginx.org/en/docs/http/ngx_http_proxy_module.html&lt;br&gt;
ngx_stream_proxy_module：http://nginx.org/en/docs/stream/ngx_stream_proxy_module.html&lt;/p&gt;</description></item><item><title>Tomcat</title><link>https://blog.liangml.dpdns.org/posts/tomcat/</link><pubDate>Sat, 12 Oct 2024 15:50:07 +0800</pubDate><guid>https://blog.liangml.dpdns.org/posts/tomcat/</guid><category domain="https://blog.liangml.dpdns.org/categories/tomcat/">Tomcat</category><description>&lt;h1 class="heading-element" id="版本号隐藏"&gt;&lt;span&gt;版本号隐藏&lt;/span&gt;
 &lt;a href="#%e7%89%88%e6%9c%ac%e5%8f%b7%e9%9a%90%e8%97%8f" class="heading-mark"&gt;
 &lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"&gt;&lt;/path&gt;&lt;/svg&gt;
 &lt;/a&gt;
&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;进入到tomcat 目录&lt;/li&gt;
&lt;li&gt;mv webapps/ROOT webapps/ROOT&lt;/li&gt;
&lt;li&gt;mkdir webapps/ROOT$(date +%Y%m%d)&lt;/li&gt;
&lt;li&gt;编辑conf/server.xml配置文件中的配置项中添加如下配置：&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;Valve className=&amp;#34;org.apache.catalina.valves.ErrorReportValve&amp;#34; showReport=&amp;#34;false&amp;#34; showServerInfo=&amp;#34;false&amp;#34; /&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start="5"&gt;
&lt;li&gt;修改后再次访问，返回404&lt;/li&gt;
&lt;/ol&gt;</description></item></channel></rss>