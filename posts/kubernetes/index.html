<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>Kubernetes - LEON BLOG</title><meta name=author content="Leon">
<meta name=description content='资源清单格式 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 apiVersion: group/apiversion # 指定当前的组和版本（写的资源清单具体去哪个路径下调代码）。如果没有给定 group 名称，那么默认为 core，可以使用 kubectl api-versions # 获取当前 k8s 版本上所有的 apiVersion 版本信息( 每个版本可能不同 ) kind: Service #资源类别 metadata: #资源元数据 name: pod-demo #资源对象名称； namespace: default #使用名称级别的资源才需要填写； #处于default名称空间下； lables: #标签，筛选操作；一般用于集群内部的筛选功能； app: myapp #标签 annotations: # 主要目的是方便用户阅读查找 spec: # 期望的状态（disired state） containers: #代表mainC； - name: myapp-1 #mainC子对象1名称；列表开头使用 -开头 image: wangyanglinux/myapp:v1 - name: busybox-1 #mainC子对象2名称； image: busybox:1.35.0 command: #此处代表的是ENTRYPOINT； - "/bin/sh" - "-c" - "sleep 3600" status: # 当前状态，本字段有 Kubernetes 自身维护，用户不能去定义 字段格式配置 1 2 3 4 5 6 7 8 apiVersion <string> #表示字符串类型 metadata <Object> #表示需要嵌套多层字段 labels <map[string]string> #表示由k:v组成的映射 finalizers <[]string> #表示字串列表 ownerReferences <[]Object> #表示对象列表 hostPID <boolean> #布尔类型 priority <integer> #整型 name <string> -required- #如果类型后面接 -required-，表示为必填字段 常用资源清单格式定义 Object ：对象，下方是对象的属性
list：类别，下方包含多个数组，每个数组是一个对象
String：字符串 后边直接跟value的值
'><meta name=keywords content='k8s'><meta itemprop=name content="Kubernetes"><meta itemprop=description content='资源清单格式 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 apiVersion: group/apiversion # 指定当前的组和版本（写的资源清单具体去哪个路径下调代码）。如果没有给定 group 名称，那么默认为 core，可以使用 kubectl api-versions # 获取当前 k8s 版本上所有的 apiVersion 版本信息( 每个版本可能不同 ) kind: Service #资源类别 metadata: #资源元数据 name: pod-demo #资源对象名称； namespace: default #使用名称级别的资源才需要填写； #处于default名称空间下； lables: #标签，筛选操作；一般用于集群内部的筛选功能； app: myapp #标签 annotations: # 主要目的是方便用户阅读查找 spec: # 期望的状态（disired state） containers: #代表mainC； - name: myapp-1 #mainC子对象1名称；列表开头使用 -开头 image: wangyanglinux/myapp:v1 - name: busybox-1 #mainC子对象2名称； image: busybox:1.35.0 command: #此处代表的是ENTRYPOINT； - "/bin/sh" - "-c" - "sleep 3600" status: # 当前状态，本字段有 Kubernetes 自身维护，用户不能去定义 字段格式配置 1 2 3 4 5 6 7 8 apiVersion <string> #表示字符串类型 metadata <Object> #表示需要嵌套多层字段 labels <map[string]string> #表示由k:v组成的映射 finalizers <[]string> #表示字串列表 ownerReferences <[]Object> #表示对象列表 hostPID <boolean> #布尔类型 priority <integer> #整型 name <string> -required- #如果类型后面接 -required-，表示为必填字段 常用资源清单格式定义 Object ：对象，下方是对象的属性
list：类别，下方包含多个数组，每个数组是一个对象
String：字符串 后边直接跟value的值'><meta itemprop=datePublished content="2025-01-07T19:07:33+08:00"><meta itemprop=dateModified content="2025-01-07T19:07:33+08:00"><meta itemprop=wordCount content="14216"><meta itemprop=image content="https://liangml.github.io/logo.png"><meta itemprop=keywords content="K8s"><meta property="og:url" content="https://liangml.github.io/posts/kubernetes/"><meta property="og:site_name" content="LEON BLOG"><meta property="og:title" content="Kubernetes"><meta property="og:description" content='资源清单格式 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 apiVersion: group/apiversion # 指定当前的组和版本（写的资源清单具体去哪个路径下调代码）。如果没有给定 group 名称，那么默认为 core，可以使用 kubectl api-versions # 获取当前 k8s 版本上所有的 apiVersion 版本信息( 每个版本可能不同 ) kind: Service #资源类别 metadata: #资源元数据 name: pod-demo #资源对象名称； namespace: default #使用名称级别的资源才需要填写； #处于default名称空间下； lables: #标签，筛选操作；一般用于集群内部的筛选功能； app: myapp #标签 annotations: # 主要目的是方便用户阅读查找 spec: # 期望的状态（disired state） containers: #代表mainC； - name: myapp-1 #mainC子对象1名称；列表开头使用 -开头 image: wangyanglinux/myapp:v1 - name: busybox-1 #mainC子对象2名称； image: busybox:1.35.0 command: #此处代表的是ENTRYPOINT； - "/bin/sh" - "-c" - "sleep 3600" status: # 当前状态，本字段有 Kubernetes 自身维护，用户不能去定义 字段格式配置 1 2 3 4 5 6 7 8 apiVersion <string> #表示字符串类型 metadata <Object> #表示需要嵌套多层字段 labels <map[string]string> #表示由k:v组成的映射 finalizers <[]string> #表示字串列表 ownerReferences <[]Object> #表示对象列表 hostPID <boolean> #布尔类型 priority <integer> #整型 name <string> -required- #如果类型后面接 -required-，表示为必填字段 常用资源清单格式定义 Object ：对象，下方是对象的属性
list：类别，下方包含多个数组，每个数组是一个对象
String：字符串 后边直接跟value的值'><meta property="og:locale" content="zh_CN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-01-07T19:07:33+08:00"><meta property="article:modified_time" content="2025-01-07T19:07:33+08:00"><meta property="article:tag" content="K8s"><meta property="og:image" content="https://liangml.github.io/logo.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://liangml.github.io/logo.png"><meta name=twitter:title content="Kubernetes"><meta name=twitter:description content='资源清单格式 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 apiVersion: group/apiversion # 指定当前的组和版本（写的资源清单具体去哪个路径下调代码）。如果没有给定 group 名称，那么默认为 core，可以使用 kubectl api-versions # 获取当前 k8s 版本上所有的 apiVersion 版本信息( 每个版本可能不同 ) kind: Service #资源类别 metadata: #资源元数据 name: pod-demo #资源对象名称； namespace: default #使用名称级别的资源才需要填写； #处于default名称空间下； lables: #标签，筛选操作；一般用于集群内部的筛选功能； app: myapp #标签 annotations: # 主要目的是方便用户阅读查找 spec: # 期望的状态（disired state） containers: #代表mainC； - name: myapp-1 #mainC子对象1名称；列表开头使用 -开头 image: wangyanglinux/myapp:v1 - name: busybox-1 #mainC子对象2名称； image: busybox:1.35.0 command: #此处代表的是ENTRYPOINT； - "/bin/sh" - "-c" - "sleep 3600" status: # 当前状态，本字段有 Kubernetes 自身维护，用户不能去定义 字段格式配置 1 2 3 4 5 6 7 8 apiVersion <string> #表示字符串类型 metadata <Object> #表示需要嵌套多层字段 labels <map[string]string> #表示由k:v组成的映射 finalizers <[]string> #表示字串列表 ownerReferences <[]Object> #表示对象列表 hostPID <boolean> #布尔类型 priority <integer> #整型 name <string> -required- #如果类型后面接 -required-，表示为必填字段 常用资源清单格式定义 Object ：对象，下方是对象的属性
list：类别，下方包含多个数组，每个数组是一个对象
String：字符串 后边直接跟value的值'><meta name=application-name content="Leon的小站"><meta name=apple-mobile-web-app-title content="Leon的小站"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=/favicon.svg><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical type=text/html href=https://liangml.github.io/posts/kubernetes/ title="Kubernetes - LEON BLOG"><link rel=prev type=text/html href=https://liangml.github.io/posts/golang-guide/ title=Golang-Guide><link rel=alternate type=text/markdown href=https://liangml.github.io/posts/kubernetes/index.md title="Kubernetes - LEON BLOG"><link rel=stylesheet href=/css/style.min.999fc44987aa81959766023190aed3b84fc2e373f70cb60d0bf85ba5d7d93d79.css integrity="sha256-mZ/ESYeqgZWXZgIxkK7TuE/C43P3DLYNC/hbpdfZPXk="><link rel=preload href=/lib/fontawesome-free/all.min.320d572dfb844e7152480b7b62374236c4896ccca3ac9d69bb03f3bc2034acb8.css integrity="sha256-Mg1XLfuETnFSSAt7YjdCNsSJbMyjrJ1puwPzvCA0rLg=" as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.320d572dfb844e7152480b7b62374236c4896ccca3ac9d69bb03f3bc2034acb8.css integrity="sha256-Mg1XLfuETnFSSAt7YjdCNsSJbMyjrJ1puwPzvCA0rLg="></noscript><link rel=preload href=/lib/animate/animate.min.5fbaeb9f8e25d7e0143bae61d4b1802c16ce7390b96ceb2d498b0d96ff4c853f.css integrity="sha256-X7rrn44l1+AUO65h1LGALBbOc5C5bOstSYsNlv9MhT8=" as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/animate/animate.min.5fbaeb9f8e25d7e0143bae61d4b1802c16ce7390b96ceb2d498b0d96ff4c853f.css integrity="sha256-X7rrn44l1+AUO65h1LGALBbOc5C5bOstSYsNlv9MhT8="></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Kubernetes","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/liangml.github.io\/posts\/kubernetes\/"},"image":["https:\/\/liangml.github.io\/favicon.ico"],"genre":"posts","keywords":"k8s","wordcount":14216,"url":"https:\/\/liangml.github.io\/posts\/kubernetes\/","datePublished":"2025-01-07T19:07:33+08:00","dateModified":"2025-01-07T19:07:33+08:00","publisher":{"@type":"Organization","name":"Leehow","logo":"https:\/\/liangml.github.io\/logo.png"},"author":{"@type":"Person","name":"Leon"},"description":""}</script><script src=/js/head/color-scheme.min.15fc6d693c4ea1331dfdbe98e8c76402340195b0a3b4047378cec39b7c827bfa.js integrity="sha256-FfxtaTxOoTMd/b6Y6MdkAjQBlbCjtARzeM7Dm3yCe/o="></script></head><body data-header-desktop=sticky data-header-mobile=auto><div class=wrapper data-page-style=normal><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper data-github-corner=right><div class=header-title><a href=/ title="LEON BLOG"><img loading=lazy src=/logo.png alt="LEON BLOG" data-title="LEON BLOG" width=26 height=26 class=logo style="background:url(/images/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title;for(const e of["style","data-title","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title;for(const e of["style","data-title","onerror","onload"])this.removeAttribute(e)'><span class=header-title-text>Kylin Blog</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class="menu-item has-children"><a class=menu-link href=/archives/><i class="fa-solid fa-feather fa-fw fa-sm" aria-hidden=true></i> 文章</a><i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden=true></i><ul class=sub-menu><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/collections/><i class="fa-solid fa-layer-group fa-fw fa-sm" aria-hidden=true></i> 合集</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li></ul></li><li class="menu-item delimiter"></li><li class="menu-item search" id=search-desktop><input type=text placeholder=搜索文章标题或内容…… id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="LEON BLOG"><img loading=lazy src=/logo.png alt="LEON BLOG" data-title="LEON BLOG" width=26 height=26 class=logo style="background:url(/images/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title;for(const e of["style","data-title","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title;for(const e of["style","data-title","onerror","onload"])this.removeAttribute(e)'><span class=header-title-text>Kylin Blog</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容…… id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></li><li class=menu-item><span class=nested-item><a class=menu-link href=/archives/><i class="fa-solid fa-feather fa-fw fa-sm" aria-hidden=true></i> 文章</a>
<i class="dropdown-icon fa-solid fa-chevron-right" aria-hidden=true></i></span><ul class=sub-menu><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/collections/><i class="fa-solid fa-layer-group fa-fw fa-sm" aria-hidden=true></i> 合集</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li></ul></li><li class="menu-item menu-system"><span class="menu-system-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></span></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=container><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label=合集><div class="details collection-details open"><div class="details-summary collection-summary"><i class="fa-solid fa-layer-group fa-fw" aria-hidden=true></i>
<span class=collection-name data-collections=合集>Kubernetes</span>
<span class=collection-count>1</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class="details-content collection-content"><nav><ul class=collection-list><li class=collection-item><span class=active title=Kubernetes>Kubernetes</span></li></ul><div class=collection-nav-simple><i class="fa-solid fa-angle-left fa-fw collection-nav-item text-secondary" aria-hidden=true></i><span class=text-secondary>1/1</span><i class="fa-solid fa-angle-right fa-fw collection-nav-item text-secondary" aria-hidden=true></i></div></nav></div></div></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>Kubernetes</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><span class=author><i class="fa-solid fa-user-circle" aria-hidden=true></i>
Leon</span></span><span class=post-included-in>&nbsp;收录于 <a href=/categories/kubernetes/ class=post-category title="分类 - Kubernetes"><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> Kubernetes</a> 和 <a href=/collections/kubernetes/ class=post-collection title="合集 - Kubernetes"><i class="fa-solid fa-layer-group fa-fw" aria-hidden=true></i> Kubernetes</a></span></div><div class=post-meta-line><span title="发布于 2025-01-07 19:07:33"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden=true></i><time datetime=2025-01-07>2025-01-07</time></span>&nbsp;<span title="14216 字"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden=true></i>约 14300 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden=true></i>预计阅读 29 分钟</span>&nbsp;<span id=busuanzi_container_page_pv class="busuanzi_visitors comment-visitors" data-flag-title=Kubernetes><i class="fa-regular fa-eye fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_page_pv>-</span>&nbsp;次阅读
</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#资源清单格式>资源清单格式</a></li><li><a href=#字段格式配置>字段格式配置</a></li><li><a href=#常用资源清单格式定义>常用资源清单格式定义</a><ul><li><a href=#通用字段>通用字段</a></li><li><a href=#metadate相关字段>metadate相关字段</a></li><li><a href=#pod相关字段>pod相关字段</a><ul><li><a href=#mainc字段>mainC字段</a></li><li><a href=#就绪探针>就绪探针</a></li><li><a href=#存活探针>存活探针</a></li><li><a href=#钩子字段>钩子字段</a></li><li><a href=#initc字段>initC字段</a></li></ul></li><li><a href=#控制器通用字段>控制器通用字段</a><ul><li><a href=#标签选择标签选择器>标签选择—标签选择器</a></li></ul></li><li><a href=#rc-控制器>RC 控制器</a></li><li><a href=#rs控制器>RS控制器</a></li><li><a href=#deployment控制器>deployment控制器</a></li><li><a href=#job控制器>job控制器</a></li><li><a href=#cronjob控制器>CronJob控制器</a></li><li><a href=#service>service</a></li><li><a href=#endpoint>Endpoint</a></li><li><a href=#ingress>ingress</a></li><li><a href=#configmap>configmap</a><ul><li><a href=#在资源清单中添加环境变量>在资源清单中添加环境变量</a></li><li><a href=#通过configmap逐个添加env变量名容器内二次定义>通过ConfigMap逐个添加env（变量名容器内二次定义）</a></li><li><a href=#通过configmap批量添加env变量名无法二次定义>通过ConfigMap批量添加env（变量名无法二次定义）</a></li><li><a href=#通过数据卷插件使用configmap>通过数据卷插件使用configmap</a></li><li><a href=#configmap的热更新修改-pod-annotations-的方式>configmap的热更新（修改 pod annotations 的方式）</a></li></ul></li><li><a href=#secret>secret</a><ul><li><a href=#service-account>service Account</a></li><li><a href=#opaque-secret>Opaque Secret</a></li></ul></li><li><a href=#volume>volume</a><ul><li><a href=#emptydir空目录>emptyDir（空目录）</a></li><li><a href=#hostpath>hostPath</a></li></ul></li><li><a href=#pvc持久化卷>PVC持久化卷</a><ul><li><a href=#pv>PV</a></li><li><a href=#pvc>PVC</a></li></ul></li><li><a href=#调度器>调度器</a><ul><li><a href=#节点亲和性>节点亲和性</a></li><li><a href=#pod亲和性>pod亲和性</a></li></ul></li><li><a href=#亲和性相关运算符>亲和性相关运算符</a><ul><li><a href=#固定节点调度>固定节点调度</a></li></ul></li><li><a href=#污点与容忍>污点与容忍</a><ul><li><a href=#污点>污点</a></li><li><a href=#容忍字段>容忍字段</a></li></ul></li><li><a href=#rbac>RBAC</a><ul><li><a href=#role-and-clusterrole>Role and ClusterRole</a></li><li><a href=#rolebinding-and-clusterrolebinding>RoleBinding and ClusterRoleBinding</a></li><li><a href=#resources子资源>Resources（子资源）</a></li><li><a href=#to-subjects>to Subjects</a></li></ul></li><li><a href=#资源限制>资源限制</a></li></ul></li></ul></nav></div></div><div class=content id=content><h2 id=资源清单格式 class=heading-element><span>资源清单格式</span>
<a href=#%e8%b5%84%e6%ba%90%e6%b8%85%e5%8d%95%e6%a0%bc%e5%bc%8f class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>group/apiversion  # 指定当前的组和版本（写的资源清单具体去哪个路径下调代码）。如果没有给定 group 名称，那么默认为 core，可以使用 kubectl api-versions</span><span class=w> </span><span class=c># 获取当前 k8s 版本上所有的 apiVersion 版本信息( 每个版本可能不同 )</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Service     </span><span class=w> </span><span class=c>#资源类别</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w> </span><span class=c>#资源元数据</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>pod-demo     </span><span class=w> </span><span class=c>#资源对象名称；</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>default   #使用名称级别的资源才需要填写；</span><span class=w> </span><span class=c>#处于default名称空间下；</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>lables</span><span class=p>:</span><span class=w> </span><span class=c>#标签，筛选操作；一般用于集群内部的筛选功能；</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>myapp               </span><span class=w> </span><span class=c>#标签</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>annotations</span><span class=p>:</span><span class=w>   </span><span class=c># 主要目的是方便用户阅读查找</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w> </span><span class=c># 期望的状态（disired state）</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>containers</span><span class=p>:</span><span class=w> </span><span class=c>#代表mainC；</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>myapp-1           </span><span class=w> </span><span class=c>#mainC子对象1名称；列表开头使用   -开头</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>wangyanglinux/myapp:v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>busybox-1           </span><span class=w> </span><span class=c>#mainC子对象2名称；</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>busybox:1.35.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class=c>#此处代表的是ENTRYPOINT；</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=s2>&#34;/bin/sh&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=s2>&#34;-c&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=s2>&#34;sleep 3600&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>status</span><span class=p>:</span><span class=w> </span><span class=c># 当前状态，本字段有 Kubernetes 自身维护，用户不能去定义</span></span></span></code></pre></td></tr></table></div></div><h2 id=字段格式配置 class=heading-element><span>字段格式配置</span>
<a href=#%e5%ad%97%e6%ae%b5%e6%a0%bc%e5%bc%8f%e9%85%8d%e7%bd%ae class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>apiVersion &lt;string&gt;          <span class=c1>#表示字符串类型</span>
</span></span><span class=line><span class=cl>metadata &lt;Object&gt;            <span class=c1>#表示需要嵌套多层字段</span>
</span></span><span class=line><span class=cl>labels &lt;map<span class=o>[</span>string<span class=o>]</span>string&gt;   <span class=c1>#表示由k:v组成的映射</span>
</span></span><span class=line><span class=cl>finalizers &lt;<span class=o>[]</span>string&gt;        <span class=c1>#表示字串列表</span>
</span></span><span class=line><span class=cl>ownerReferences &lt;<span class=o>[]</span>Object&gt;   <span class=c1>#表示对象列表</span>
</span></span><span class=line><span class=cl>hostPID &lt;boolean&gt;            <span class=c1>#布尔类型</span>
</span></span><span class=line><span class=cl>priority &lt;integer&gt;           <span class=c1>#整型</span>
</span></span><span class=line><span class=cl>name &lt;string&gt; -required-     <span class=c1>#如果类型后面接 -required-，表示为必填字段</span></span></span></code></pre></td></tr></table></div></div><h2 id=常用资源清单格式定义 class=heading-element><span>常用资源清单格式定义</span>
<a href=#%e5%b8%b8%e7%94%a8%e8%b5%84%e6%ba%90%e6%b8%85%e5%8d%95%e6%a0%bc%e5%bc%8f%e5%ae%9a%e4%b9%89 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><blockquote><p>Object ：对象，下方是对象的属性<br>list：类别，下方包含多个数组，每个数组是一个对象<br>String：字符串 后边直接跟value的值</p></blockquote><h3 id=通用字段 class=heading-element><span>通用字段</span>
<a href=#%e9%80%9a%e7%94%a8%e5%ad%97%e6%ae%b5 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><table><thead><tr><th>参数名</th><th>字段类型</th><th>说明</th></tr></thead><tbody><tr><td>version</td><td>String</td><td>这里是指的是K8S API的版本，目前基本上是v1，可以用kubectl apiversions命令音询</td></tr><tr><td>kind</td><td>String</td><td>这里指的是yamI文件定义的资源类型和角色，比如: Pod</td></tr><tr><td>metadata</td><td>Object</td><td>元数据对象，固定值就写metadata</td></tr><tr><td>Spec</td><td>bject</td><td>详细定义对象，固定值就写Spec</td></tr></tbody></table><h3 id=metadate相关字段 class=heading-element><span>metadate相关字段</span>
<a href=#metadate%e7%9b%b8%e5%85%b3%e5%ad%97%e6%ae%b5 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><table><thead><tr><th>参数名</th><th>字段类型</th><th>说明</th></tr></thead><tbody><tr><td>metadata</td><td>Object</td><td>元数据对象，固定值就写metadata</td></tr><tr><td>metadata.name</td><td>String</td><td>元数据对象的名字，这里由我们编写，比如命名Pod的名字</td></tr><tr><td>metadata.lables</td><td>list</td><td>标签列表。有key=value组成</td></tr></tbody></table><h3 id=pod相关字段 class=heading-element><span>pod相关字段</span>
<a href=#pod%e7%9b%b8%e5%85%b3%e5%ad%97%e6%ae%b5 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><table><thead><tr><th>参数名</th><th>字段类型</th><th>说明</th></tr></thead><tbody><tr><td>spec.restartPolicy</td><td>String</td><td>定义Pod的重启策略，可选值为Always、OnFailure，默认值为Always。1.Always: Pod一旦终止运行，则无论容器是如何终止的，kubelet服务都将重启它。2.OnFailure: 只有Pod以非零退出码终止时，kubelet才会重启该容器。如果容器正常结束 (退出码为0) ，则kubelet将不会重启它3.Never: Pod终止后，kubelet将退出码报告给Master，不会重启该Pod.</td></tr><tr><td>spec.nodeSelector</td><td>Object</td><td>定义Node的Label过滤标签，以key:value格式指定</td></tr><tr><td>spec.imagePullSecrets</td><td>Object</td><td>定义pull镜像时使用secret名称，以name:secretkey格式指定</td></tr><tr><td>spec.hostNetwork</td><td>Boolean</td><td>定义是否使用主机网络模式，默认值为false。设置true表示使用宿主机网络，不使用docker网桥，同时设置了true将无法在同一台宿主机上启动第二个副本。</td></tr><tr><td>sepc.NodeName</td><td>string</td><td>定义pod要调度的节点，可以忽略污点，还是要预选、优选。</td></tr></tbody></table><h4 id=mainc字段 class=heading-element><span>mainC字段</span>
<a href=#mainc%e5%ad%97%e6%ae%b5 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><table><thead><tr><th>参数名</th><th>字段类型</th><th>说明</th></tr></thead><tbody><tr><td>spec.containers[]</td><td>list</td><td>这里是Spec对象的容器列表定义，是个列表</td></tr><tr><td>spec.containers[].name</td><td>String</td><td>这里定义容器的名字</td></tr><tr><td>spec.containers[].image</td><td>String</td><td>这里定义要用到的镜像名称</td></tr><tr><td>spec.containers[].imagePullPolicy</td><td>String</td><td>定义镜像拉取策略，有Always、Never、lfNotPresent三个值可选 (1) Aways: 意思是每次都尝试重新拉取镜像 (2) Never: 表示仅使用本地镜像 (3) lfNotPresent: 如果本地有镜像就使用本地镜像，没有就拉取在线镜像。上面三个值都没设置的话，默认是Always。</td></tr><tr><td>spec.containers[].command[]</td><td>List</td><td>指定容器启动命令，因为是数组可以指定多个，不指定则使用镜像打包时使用的启动命令</td></tr><tr><td>spec.containers[].args[]</td><td>List</td><td>指定容器启动命令参数，因为是数组可以指定多个。</td></tr><tr><td>spec.containers[].workingDir</td><td>string</td><td>指定容器的工作目录</td></tr><tr><td>spec.containers[].volumeMounts[]</td><td>List</td><td>指定容器内部的存储卷配置</td></tr><tr><td>spec.containers[].volumeMounts[].name</td><td>String</td><td>指定可以被容器挂载的存储卷的名称</td></tr><tr><td>spec.containers[].volumeMounts[].mountPath</td><td>string</td><td>指定可以被容器挂载的存储卷的路径</td></tr><tr><td>spec.containers[].volumeMounts[].readOnly</td><td>string</td><td>设置存储卷路径的读写模式，ture 或者false默认为读写模式</td></tr><tr><td>spec.containers[].ports[]</td><td>List</td><td>指定容器需要用到的端口列表</td></tr><tr><td>spec.containers[].ports[].name</td><td>String</td><td>指定端口名称</td></tr><tr><td>spec.containers[].ports[].containerPort</td><td>String</td><td>指定容器需要监听的端口号</td></tr><tr><td>spec.containers[].ports[].hostPort</td><td>String</td><td>指定容器所在主机需要监听的端口号，默认跟上面containerPort相同，注意设置了hostPort同一台主机无法启动该容器的相同副本 (因为主机的端口号不能相同，这样会冲突)</td></tr><tr><td>spec.containers[].ports[].protocol</td><td>String</td><td>指定端口协议，支持TCP和UDP，默认值为TCP</td></tr><tr><td>spec.containers[].env[]</td><td>List</td><td>指定容器运行前需设置的环境变量列表</td></tr><tr><td>spec.containers[].env[].name</td><td>string</td><td>指定环境变量名称</td></tr><tr><td>spec.containers[].env[].value</td><td>String</td><td>指定环境变量值</td></tr><tr><td>spec.containers[].resources</td><td>Object</td><td>指定资源限制和资源请求的值 (这里开始就是设置容器的资源上限)</td></tr><tr><td>spec.containers[].resources.limits</td><td>Object</td><td>指定设置容器运行时资源的运行上限</td></tr><tr><td>spec.containers[].resources.limits.cpu</td><td>String</td><td>指定CPU的限制，单位为core数，将用于docker run &ndash;cpu-shares参数 (这里前面文章Pod资源限制有讲过)</td></tr><tr><td>spec.containers[].resources.limits.memory</td><td>String</td><td>指定MEM内存的限制，单位为MIB、GiB</td></tr><tr><td>spec.containers[].resources.requests</td><td>Object</td><td>指定容器启动和调度时的限制设置</td></tr><tr><td>spec.containers[].resources.requests.cpu</td><td>String</td><td>CPU请求，单位为core数，容器启动时初始化可用数量</td></tr><tr><td>spec.containers[].resources.requests.memory</td><td>String</td><td>内存请求，单位为MIB、GiB，容器启动的初始化可用数量</td></tr></tbody></table><h4 id=就绪探针 class=heading-element><span>就绪探针</span>
<a href=#%e5%b0%b1%e7%bb%aa%e6%8e%a2%e9%92%88 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><table><thead><tr><th>参数名</th><th>字段类型</th><th>说明</th></tr></thead><tbody><tr><td>spec.containers.readinessProbe</td><td>Object</td><td>定义容器的就绪探测策略。有三种模式可选:<br>exec：返回码为0为就绪<br>tcpsoket：tcp 对应检测端口响应成功为就绪<br>httpget：返回码 >= 200 && &lt; 400 为就绪</td></tr><tr><td>spec.containers.readinessProbe.exec</td><td>list</td><td>定义容器的就绪探测策略为exec。</td></tr><tr><td>spec.containers.readinessProbe.exec.command</td><td>List</td><td>exec所对应的命令</td></tr><tr><td>spec.containers.readinessProbe.initialDelaySeconds</td><td>init</td><td>探测开始时间</td></tr><tr><td>spec.containers.readinessProbe.periodSeconds</td><td>init</td><td>探测间隔时间。s为单位</td></tr></tbody></table><h4 id=存活探针 class=heading-element><span>存活探针</span>
<a href=#%e5%ad%98%e6%b4%bb%e6%8e%a2%e9%92%88 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><table><thead><tr><th>参数名</th><th>字段类型</th><th>说明</th></tr></thead><tbody><tr><td>spec.containers.livenessProbe</td><td>object</td><td>定义容器的就绪探测策略。有三种模式可选:<br>exec：返回码为0为就绪<br>tcpsoket：tcp 对应检测端口响应成功为就绪<br>httpget：返回码 >= 200 && &lt; 400 为就绪</td></tr><tr><td>spec.containers.livenessProbe.httpGet</td><td>object</td><td>定义容器的就绪探测策略为httpGet。</td></tr><tr><td>spec.containers.livenessProbe.httpGet.port</td><td>init</td><td>探测的端口</td></tr><tr><td>spec.containers.livenessProbe.httpGet.path</td><td>string</td><td>探测的文件。根为网页根路径</td></tr><tr><td>spec.containers.livenessProbe.initialDelaySeconds</td><td>init</td><td>探测开始时间</td></tr><tr><td>spec.containers.livenessProbe.periodSeconds</td><td>init</td><td>探测间隔时间。s为单位</td></tr><tr><td>spec.containers.livenessProbe.timeoutSeconds</td><td>init</td><td>探测超时时间，超时后就是探测失败</td></tr></tbody></table><h4 id=钩子字段 class=heading-element><span>钩子字段</span>
<a href=#%e9%92%a9%e5%ad%90%e5%ad%97%e6%ae%b5 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><table><thead><tr><th>参数名</th><th>字段类型</th><th>说明</th></tr></thead><tbody><tr><td>spec.containers.lifecycle</td><td>object</td><td>定义钩子</td></tr><tr><td>spec.containers.lifecycle.postStart</td><td>object</td><td>定义启动后的钩子</td></tr><tr><td>spec.containers.lifecycle.preStop</td><td>object</td><td>定义退出前钩子</td></tr><tr><td>spec.containers.lifecycle.postStart.exec</td><td>object</td><td>定义启动后的钩子动作为命令</td></tr><tr><td>spec.containers.lifecycle.postStart.exec.command</td><td>list</td><td>定义启动后的钩子详细动作</td></tr></tbody></table><h4 id=initc字段 class=heading-element><span>initC字段</span>
<a href=#initc%e5%ad%97%e6%ae%b5 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><blockquote><p>与容器字段通过，只不过把containers换成initcontainers</p></blockquote><table><thead><tr><th>参数名</th><th>字段类型</th><th>说明</th></tr></thead><tbody><tr><td>spec.initcontainers[]</td><td>list</td><td>这里是Spec对象的容器列表定义，是个列表，定义initC容器</td></tr><tr><td>spec.initcontainers[].name</td><td>String</td><td>这里定义容器的名字</td></tr><tr><td>spec.initcontainers[].image</td><td>String</td><td>这里定义要用到的镜像名称</td></tr><tr><td>spec.initcontainers[].command[]</td><td>List</td><td>指定容器启动命令，因为是数组可以指定多个，不指定则使用镜像打包时使用的启动命令</td></tr></tbody></table><h3 id=控制器通用字段 class=heading-element><span>控制器通用字段</span>
<a href=#%e6%8e%a7%e5%88%b6%e5%99%a8%e9%80%9a%e7%94%a8%e5%ad%97%e6%ae%b5 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><table><thead><tr><th>参数名</th><th>字段类型</th><th>说明</th></tr></thead><tbody><tr><td>spec.replicas</td><td>init</td><td>副本数（pod数量）</td></tr><tr><td>spec.template</td><td>object</td><td>pod模板，内容就是pod中的字段内容</td></tr><tr><td>spec.selector</td><td>object</td><td>标签匹配（用来区分是谁的pod），将适合的pod加入到该该控制器下 内容是：标签：值</td></tr><tr><td>spec.minReadySeconds</td><td>init</td><td>用定义新建的 Pod 经过多少秒后才被视为可用，默认为0。</td></tr><tr><td>spec.backoffLimit</td><td>init</td><td>失败次数达到指定次数之后进入懒启动状态（重建间隔时间长）</td></tr></tbody></table><h4 id=标签选择标签选择器 class=heading-element><span>标签选择—标签选择器</span>
<a href=#%e6%a0%87%e7%ad%be%e9%80%89%e6%8b%a9%e6%a0%87%e7%ad%be%e9%80%89%e6%8b%a9%e5%99%a8 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><blockquote><p>处理RC其他都支持</p></blockquote><table><thead><tr><th>参数名</th><th>字段类型</th><th>说明</th></tr></thead><tbody><tr><td>spec.selector</td><td>object</td><td>标签匹配（用来区分是谁的pod），将适合的pod加入到该该控制器下</td></tr><tr><td>spec.selector.matchLabels[]</td><td>list</td><td>集合式的标签匹配（用来区分是谁的pod），将适合的pod加入到该该控制器下内容是：标签：值（RS支持）</td></tr><tr><td>spec.selector.matchExpressions[]</td><td>object</td><td>支持运算符匹配进行标签选择（用来区分是谁的pod），将适合的pod加入到该该控制器下<br>内容是：<br>key： xxxx<br>operator: 运算符<br>vlaues：<br>- xxxx</td></tr><tr><td>spec.selector.matchExpressions[].key</td><td>string</td><td>标签选择器的key字段</td></tr><tr><td>spec.selector.matchExpressions.operator</td><td>string</td><td>标签选择的运算符，有In、NotIn、Exists、DoesNotExist 四个值可选<br>In ：label 的值在某个列表中（根据value的值进行选择）<br>NotIn ：label 的值不在某个列表中<br>Exists ：某个 label 存在（根据key进行选择）<br>DoesNotExist：某个 label 不存在</td></tr><tr><td>spec.selector.matchExpressions[].values</td><td>list</td><td>标签选择器下的value字段</td></tr></tbody></table><h3 id=rc-控制器 class=heading-element><span>RC 控制器</span>
<a href=#rc-%e6%8e%a7%e5%88%b6%e5%99%a8 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><table><thead><tr><th>参数名</th><th>字段类型</th><th>说明</th></tr></thead><tbody><tr><td>spec.selector</td><td>list</td><td>标签匹配（用来区分是谁的pod），将适合的pod加入到该该控制器下 内容是：标签：值</td></tr></tbody></table><ul><li>RC （ReplicationController ）主要的作用就是用来确保容器应用的副本数始终保持在用户定义的副本数
。即如果有容器异常退出，会自动创建新的Pod来替代；而如果异常多出来的容器也会自动回收（回收最晚创建的）</li><li>根据标签确认是否输入控制器</li><li>不支持集合式的标签匹配</li></ul><h3 id=rs控制器 class=heading-element><span>RS控制器</span>
<a href=#rs%e6%8e%a7%e5%88%b6%e5%99%a8 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><table><thead><tr><th>参数名</th><th>字段类型</th><th>说明</th></tr></thead><tbody><tr><td>spec.minReadySeconds</td><td>init</td><td>用定义新建的 Pod 经过多少秒后才被视为可用，默认为0。</td></tr><tr><td>spec.selector.matchLabels[]</td><td>list</td><td>集合式的标签匹配（用来区分是谁的pod），将适合的pod加入到该该控制器下内容是：标签：值（RS支持）</td></tr><tr><td>spec.selector.matchExpressions[]</td><td>object</td><td>支持运算符匹配进行标签选择（用来区分是谁的pod），将适合的pod加入到该该控制器下<br>内容是：<br>key： xxxx<br>operator: 运算符<br>vlaues：xxxx</td></tr><tr><td>spec.selector.matchExpressions[].key</td><td>string</td><td>标签选择器的key字段</td></tr><tr><td>spec.selector.matchExpressions.operator</td><td>string</td><td>标签选择的运算符，有In、NotIn、Exists、DoesNotExist 四个值可选<br>In ：label 的值在某个列表中（根据value的值进行选择）<br>NotIn ：label 的值不在某个列表中<br>Exists ：某个 label 存在（根据key进行选择）<br>DoesNotExist：某个 label 不存在</td></tr><tr><td>spec.selector.matchExpressions[].values</td><td>list</td><td>标签选择器下的value字段</td></tr></tbody></table><h3 id=deployment控制器 class=heading-element><span>deployment控制器</span>
<a href=#deployment%e6%8e%a7%e5%88%b6%e5%99%a8 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><table><thead><tr><th>参数名</th><th>字段类型</th><th>说明</th></tr></thead><tbody><tr><td>spec.minReadySeconds</td><td>init</td><td>用定义新建的 Pod 经过多少秒后才被视为可用，默认为0。</td></tr><tr><td>spec.selector</td><td>list</td><td>默认标签选择器。默认是matchLabels子集形式进行匹配</td></tr><tr><td>spec.selector.matchLabels[]</td><td>list</td><td>集合式的标签匹配（用来区分是谁的pod），将适合的pod加入到该该控制器下内容是：标签：值</td></tr><tr><td>spec.selector.matchExpressions[]</td><td>object</td><td>支持运算符匹配进行标签选择（用来区分是谁的pod），将适合的pod加入到该该控制器下<br>内容是：<br>key： xxxx<br>operator: 运算符<br>vlaues：xxxx</td></tr><tr><td>spec.selector.matchExpressions[].key</td><td>string</td><td>标签选择器的key字段</td></tr><tr><td>spec.selector.matchExpressions.operator</td><td>string</td><td>标签选择的运算符，有In、NotIn、Exists、DoesNotExist 四个值可选<br>In ：label 的值在某个列表中（根据value的值进行选择）<br>NotIn ：label 的值不在某个列表中<br>Exists ：某个 label 存在（根据key进行选择）<br>DoesNotExist：某个 label 不存在<br>spec.selector.matchExpressions[].values list 标签选择器下的value字段<br>sepc.revisionHistoryLimit init 设置保留的滚动更新历史版本数量，默认值为2147483647,表示保存所有历史版本<br>spec.strategy.type string 部署类型，可以选择 的值为ecreate (字母开头大写) 或 RollingUpdate , 默认为 RollingUpdate 。</td></tr><tr><td>Deployment.spec.strategy.Recreate</td><td></td><td>滚动更新方式为重建</td></tr><tr><td>Deployment.spec.strategy.rollingUpdate</td><td>映射</td><td>滚动更新方式为滚动更新</td></tr><tr><td>Deployment.spec.strategy.rollingUpdate.maxSurge</td><td>init</td><td>设置更新时pod最多多几个（或者指定百分比）</td></tr><tr><td>Deployment.spec.strategy.rollingUpdate.maxUnavailable</td><td>init</td><td>设置更新时pod最多几个不可用（或者指定百分比）</td></tr><tr><td>Deployment.spec.revisonHistoryLimit</td><td>init</td><td>指定 deployment 最多保留多少 镜像版本修改的历史记录。默认的会保留所有的 revision；如果将该项设置为0，Deployment 就不允许回退了</td></tr></tbody></table><h3 id=job控制器 class=heading-element><span>job控制器</span>
<a href=#job%e6%8e%a7%e5%88%b6%e5%99%a8 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><table><thead><tr><th>参数名</th><th>字段类型</th><th>说明</th></tr></thead><tbody><tr><td>spec.template</td><td>–</td><td>格式同Pod相同</td></tr><tr><td>spec.template.spec.restartPolicy</td><td>String</td><td>仅支持Never或OnFailure，需要修改<br>定义Pod的重启策略，可选值为Always、OnFailure，默认值为Always。<br>1.Always: Pod一旦终止运行，则无论容器是如何终止的，kubelet服务都将重启它。<br>2.OnFailure: 只有Pod以非零退出码终止时，kubelet才会重启该容器。如果容器正常结束 (退出码为0) ，则kubelet将不会重启它<br>3.Never: Pod终止后，kubelet将退出码报告给Master，不会重启该Pod.</td></tr><tr><td>spec.completions</td><td>init</td><td>标志Job结束需要成功运行的Pod个数，默认为1</td></tr><tr><td>spec.parallelism</td><td>init</td><td>标志并行运行的Pod的个数，默认为1</td></tr><tr><td>spec.activeDeadlineSeconds</td><td>init</td><td>标志失败Pod的重试最大时间，超过这个时间不会继续重试。秒为单位</td></tr></tbody></table><h3 id=cronjob控制器 class=heading-element><span>CronJob控制器</span>
<a href=#cronjob%e6%8e%a7%e5%88%b6%e5%99%a8 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><table><thead><tr><th>参数名</th><th>字段类型</th><th>说明</th></tr></thead><tbody><tr><td>.spec.schedule</td><td>string</td><td>调度，必需字段，指定任务运行周期，格式同 Cron。如：“*/1 * * * *”</td></tr><tr><td>spec.completions</td><td>init</td><td>标志Job结束需要成功运行的Pod个数，默认为1</td></tr><tr><td>spec.parallelism</td><td>init</td><td>标志并行运行的Pod的个数，默认为1</td></tr><tr><td>spec.concurrencyPolicy</td><td>string</td><td>-并发策略，该字段也是可选的。它指定了如何处理被 Cron Job 创建的 Job 的并发执行。只允许指定下面策略中的一种：<br>Allow（默认）：允许并发运行 Job<br>Forbid：禁止并发运行，如果前一个还没有完成，则直接跳过下一个<br>Replace：取消当前正在运行的 Job，用一个新的来替换</td></tr><tr><td>spec.suspend</td><td>string</td><td>挂起，该字段也是可选的。有true、false两个值可以选择。如果设置为 true，后续所有执行都会被挂起。它对已经开始执行的 Job 不起作用。默认值为 false</td></tr><tr><td>spec.successfulJobsHistoryLimit</td><td>init</td><td>历史限制。是可选的字段。它们指定了可以保留多少完成的 Job。默认为3</td></tr><tr><td>spec.failedJobsHistoryLimit</td><td>init</td><td>历史限制。是可选的字段。它们指定了可以保留多少失败的 Job。默认为0</td></tr><tr><td>spec.activeDeadlineSeconds</td><td>init</td><td>标志失败Pod的重试最大时间，超过这个时间不会继续重试。该字段是可选的。如果因为任何原因而错过了被调度的时间，那么错过执行时间的 Job 将被认为是失败。秒为单位</td></tr><tr><td>spec.jobTemplate</td><td>object</td><td>的。如果没有指定，则没有期限Job 模板，必需字段，指定需要运行的任务，格式同 Job<br>jobTemplate.spec.template – 格式同Pod相同<br>jobTemplate.spec.template.spec.restartPolicy String 仅支持Never或OnFailure，需要修改<br>定义Pod的重启策略，可选值为Always、OnFailure，默认值为Always。<br>1.Always: Pod一旦终止运行，则无论容器是如何终止的，kubelet服务都将重启它。<br>2.OnFailure: 只有Pod以非零退出码终止时，kubelet才会重启该容器。如果容器正常结束 (退出码为0) ，则kubelet将不会重启它<br>3.Never: Pod终止后，kubelet将退出码报告给Master，不会重启该Pod.</td></tr></tbody></table><h3 id=service class=heading-element><span>service</span>
<a href=#service class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><table><thead><tr><th>参数名</th><th>字段类型</th><th>是否必选</th><th>取值说明</th></tr></thead><tbody><tr><td>.apiVersion</td><td>string</td><td>Required v1</td><td></td></tr><tr><td>.kind</td><td>string</td><td>Required Service</td><td></td></tr><tr><td>.metadata</td><td>object</td><td>Required 元数据</td><td></td></tr><tr><td>.metadata.name</td><td>string</td><td>Required Service名称，需符合RFC 1035规范</td><td></td></tr><tr><td>.metadata.namespace</td><td>string</td><td>Required 命名空间，不指定系统时将使用名为default的命名空间</td><td></td></tr><tr><td>.metadata.labels []</td><td>list</td><td>自定义标签属性列表</td><td></td></tr><tr><td>.metadata.annotation[]</td><td>list</td><td>自定义注解属性列表</td><td></td></tr><tr><td>.spec</td><td>object</td><td>Required 期望描述</td><td></td></tr><tr><td>.spec.selector[]</td><td>list</td><td>Required Label Selector配置，将选择具有指定Label标签的Pod作为管理范围</td><td></td></tr><tr><td>.spec.type</td><td>string</td><td>Requited Service的类型，指定Service的防问方式，默认值为ClusterIP。取值可有：ClusterIP、NodePort、LoadBalancer。</td><td></td></tr><tr><td>.spec.clusterIP</td><td>string</td><td>虚拟服务的IP地址，当type=ClusterIP时，如果不指定，则系统自动分配，也可以手工分配；当type=LoadBalancer时，需要指定</td><td></td></tr><tr><td>.spec.sessionAffinity</td><td>string</td><td>会话保持字段是否支持Session,可选值为ClientIP,默认值为None。ClientIP:表示将同一个客户端（根据客户端的IP地址决定）的访问请求都转发到同一个后端Pod</td><td></td></tr><tr><td>.spec.ports[]</td><td>list</td><td>Service端口列表</td><td></td></tr><tr><td>.spec.ports[].name</td><td>string</td><td>端口名称</td><td></td></tr><tr><td>.spec.ports[].protocol</td><td>string</td><td>端口协议，支持TCP和UDP，默认值为TCP</td><td></td></tr><tr><td>.spec.ports[].port</td><td>int</td><td>服务监听的端口号</td><td></td></tr><tr><td>.spec.ports[].targetPort</td><td>int</td><td>需要转发到后端Pod的端口号</td><td></td></tr><tr><td>.spec.ports[].nodePort</td><td>int</td><td>当spec.type=NodePort时，指定映射到宿主机的端口号</td><td></td></tr><tr><td>.status</td><td>object</td><td>当spec.type=LoadBalancer时，设置外部负载均衡器的地址</td><td></td></tr><tr><td>.status.loadBalancer</td><td>object</td><td>外部负载均衡器</td><td></td></tr><tr><td>.status.loadBalancer.ingress</td><td>object</td><td>外部负载均衡器</td><td></td></tr><tr><td>.status.loadBalancer.ingress.ip</td><td>string</td><td>外部负载均衡器的IP地址</td><td></td></tr><tr><td>.status.loadBalancer.ingress.hostname</td><td>string</td><td>外部负载均衡器的主机名</td><td></td></tr></tbody></table><h3 id=endpoint class=heading-element><span>Endpoint</span>
<a href=#endpoint class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><blockquote><p>作用：连接外部服务值本地svc
原理：只有配置了 selector 的 service 才会自动创建一个同名的 endpoints，没有配置 selector 的 service 不会产生 endpoints
资源对象</p></blockquote><table><thead><tr><th>参数名</th><th>字段类型</th><th>说明</th></tr></thead><tbody><tr><td>metadata.name</td><td>string</td><td>必需字段，必须与要匹配的svc名字完全一致，并且在同一名字空间中</td></tr><tr><td>svc.subsets</td><td>object</td><td>#配置外部集群信息（一级字段）</td></tr><tr><td>subsets.address</td><td>list</td><td>外部地址</td></tr><tr><td>subsets.ports</td><td>list</td><td>外部端口</td></tr></tbody></table><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>nginx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>protocol</span><span class=p>:</span><span class=w> </span><span class=l>TCP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>6666</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>targetPort</span><span class=p>:</span><span class=w> </span><span class=m>80</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Endpoints</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>nginx    </span><span class=w> </span><span class=c>#名字必须与svc名字完全一致，并且在同一名字空间中</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>subsets</span><span class=p>:</span><span class=w> </span><span class=c>#配置外部集群信息</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>addresses</span><span class=p>:</span><span class=w> </span><span class=c>#外部地址</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>ip</span><span class=p>:</span><span class=w> </span><span class=m>192.168.110.102</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c>#      - ip: xxxxxx   跟踪多个 ip (多个 pod 或者容器或者应用)，可以使用以下方式</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>80</span><span class=w>  </span><span class=c>#外部端口</span></span></span></code></pre></td></tr></table></div></div><h3 id=ingress class=heading-element><span>ingress</span>
<a href=#ingress class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><blockquote><p>Ingress（入口，准入）是Kubernetes提供的接口，Kubernetes使用Ingress策略定义和Ingress Controller
实现了基于Ingress策略定义的服务路由功能，用于对Kubernetes集群外部的客户端提供服务。<br>Ingress 专门对接用于七层负载的</p></blockquote><table><thead><tr><th>参数名</th><th>字段类型</th><th>说明</th></tr></thead><tbody><tr><td>Ingress.spec.rules</td><td>list</td><td>规则设置</td></tr><tr><td>spec.rules.host</td><td>string</td><td>代理到的域名</td></tr><tr><td>spec.rules.http</td><td>object</td><td>基于http协议</td></tr><tr><td>spec.rules.http.path</td><td>list</td><td>访问的网址路径</td></tr><tr><td>spec.rules.http.path.paths</td><td>string</td><td>访问的网址路径是哪个</td></tr><tr><td>spec.rules.http.path.paths.backend</td><td>object</td><td>代理设置</td></tr><tr><td>spec.rules.http.path.paths.backend.serviceName</td><td>string</td><td>代理到哪个svc</td></tr><tr><td>spec.rules.http.path.paths.backend.servicePort</td><td>string</td><td>代理的端口</td></tr></tbody></table><h3 id=configmap class=heading-element><span>configmap</span>
<a href=#configmap class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><blockquote><p>创建方式：使用命令创建，在命令中</p></blockquote><p>下方是如何使用：</p><h4 id=在资源清单中添加环境变量 class=heading-element><span>在资源清单中添加环境变量</span>
<a href=#%e5%9c%a8%e8%b5%84%e6%ba%90%e6%b8%85%e5%8d%95%e4%b8%ad%e6%b7%bb%e5%8a%a0%e7%8e%af%e5%a2%83%e5%8f%98%e9%87%8f class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><table><thead><tr><th>字段</th><th>字段类型</th><th>描述</th></tr></thead><tbody><tr><td>pod.spec.containers.env</td><td>list</td><td>要在容器中设置的环境变量列表。 无法更新。 EnvVar 表示容器中存在的环境变量。</td></tr><tr><td>pod.spec.containers.env.name</td><td>string</td><td>环境变量的Key值，必须设置。</td></tr><tr><td>pod.spec.containers.env.value</td><td>string</td><td>设置环境变量的Value，可以使用 <code>$(VAR_NAME)</code> 的方式对容器中的环境变量进行引用。 <code>$(VAR_NAME)</code> 表示对 <code>$</code> 进行转义，会将<code>$(VAR_NAME)</code> 以值的方式设置为环境变量的值而不是将其展开。</td></tr></tbody></table><h4 id=通过configmap逐个添加env变量名容器内二次定义 class=heading-element><span>通过ConfigMap逐个添加env（变量名容器内二次定义）</span>
<a href=#%e9%80%9a%e8%bf%87configmap%e9%80%90%e4%b8%aa%e6%b7%bb%e5%8a%a0env%e5%8f%98%e9%87%8f%e5%90%8d%e5%ae%b9%e5%99%a8%e5%86%85%e4%ba%8c%e6%ac%a1%e5%ae%9a%e4%b9%89 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><blockquote><p>key=容器定义。value=configmap中的key的value</p></blockquote><table><thead><tr><th>字段</th><th>字段类型</th><th>描述</th></tr></thead><tbody><tr><td>pod.spec.containers.env</td><td>list</td><td>要在容器中设置的环境变量列表。 无法更新。 EnvVar 表示容器中存在的环境变量。</td></tr><tr><td>pod.spec.containers.env.valueFrom</td><td>object</td><td>环境变量值的源。如果值不为空，则无法使用。</td></tr><tr><td>pod.spec.containers.env.valueFrom.configMapKeyRef</td><td>object</td><td>选择configMap中的一个Key值的字段。</td></tr><tr><td>pod.spec.contaienrs.env.valueFrom.configMapKeyRef.name</td><td>string</td><td>指定configMap的名字</td></tr><tr><td>pod.spec.containers.env.valueFrom.configMapKeyRef.key</td><td>string</td><td>指定configMap引用的key值，会将对应的value赋予环境变量的value值。</td></tr><tr><td>pod.spec.contianers.env.valueFrom.configMapKeyRef.optional</td><td>boolean</td><td>指定configMap和key值是否必需预先定义好逐个添加env（没学，不用看）</td></tr></tbody></table><h4 id=通过configmap批量添加env变量名无法二次定义 class=heading-element><span>通过ConfigMap批量添加env（变量名无法二次定义）</span>
<a href=#%e9%80%9a%e8%bf%87configmap%e6%89%b9%e9%87%8f%e6%b7%bb%e5%8a%a0env%e5%8f%98%e9%87%8f%e5%90%8d%e6%97%a0%e6%b3%95%e4%ba%8c%e6%ac%a1%e5%ae%9a%e4%b9%89 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><blockquote><p>key=configmap中的key。value=configmap中的key的value</p></blockquote><table><thead><tr><th>字段</th><th>字段类型</th><th>描述</th></tr></thead><tbody><tr><td>pod.spec.contianers.envFrom</td><td>list</td><td>用于在容器中填充 环境变量的源列表 ，格式必须为C_IDENTIFIER(C语言标识符格式标准) 。如果Key值无效则报告为事件，如果key重复，则以最后的为准，环境变量注入 无法被更新 。</td></tr><tr><td>pod.spec.containers.envFrom.configMapRef</td><td>Object</td><td>选择ConfigMap，注入环境变量</td></tr><tr><td>pod.spec.containers.envFrom.configMapRef.name</td><td>string</td><td>ConfigMap的名称</td></tr><tr><td>pod.spec.containers.optional</td><td>boolean</td><td>（没学，不用看）指定configMap是否需要被预先定义好</td></tr></tbody></table><h4 id=通过数据卷插件使用configmap class=heading-element><span>通过数据卷插件使用configmap</span>
<a href=#%e9%80%9a%e8%bf%87%e6%95%b0%e6%8d%ae%e5%8d%b7%e6%8f%92%e4%bb%b6%e4%bd%bf%e7%94%a8configmap class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><blockquote><p>将文件填入数据卷。key就是文件名，value就是文件内容</p></blockquote><table><thead><tr><th>字段</th><th>字段类型</th><th>描述</th></tr></thead><tbody><tr><td>pod.sepc.containers.volumeMounts</td><td>list</td><td>挂载一个卷</td></tr><tr><td>pod.sepc.containers.volumeMounts.name</td><td>string</td><td>挂载的卷名</td></tr><tr><td>pod.sepc.containers.volumeMounts.mountPath</td><td>srting</td><td>挂载到哪个目录下</td></tr><tr><td>pod.sepc.volumes</td><td>list</td><td>定义卷</td></tr><tr><td>pod.sepc.volumes.name</td><td>string</td><td>卷名</td></tr><tr><td>pod.sepc.volumes.name.configMap</td><td>object</td><td>卷来源是configmap</td></tr><tr><td>pod.sepc.volumes.name.configMap.name</td><td>string</td><td>configmap的名字</td></tr></tbody></table><h4 id=configmap的热更新修改-pod-annotations-的方式 class=heading-element><span>configmap的热更新（修改 pod annotations 的方式）</span>
<a href=#configmap%e7%9a%84%e7%83%ad%e6%9b%b4%e6%96%b0%e4%bf%ae%e6%94%b9-pod-annotations-%e7%9a%84%e6%96%b9%e5%bc%8f class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><blockquote><p>更新 ConfigMap 目前并不会触发相关 Pod 的滚动更新，可以通过修改 pod annotations 的方式强制触发滚动更新 这个例子里我们在
<code>.spec.template.metadata.annotations</code> 中添加 <code>version/config</code>，每次通过修改 <code>version/config</code>的值 来触发滚动更新</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ kubectl patch deployment nginx-test --patch <span class=s1>&#39;{&#34;spec&#34;: {&#34;template&#34;: {&#34;metadata&#34;: {&#34;annotations&#34;: {&#34;version/config&#34;: &#34;20190411&#34; }}}}}&#39;</span>
</span></span><span class=line><span class=cl><span class=c1># 在其中添加此字段即可滚动更新，修改也可以触发滚动更新</span></span></span></code></pre></td></tr></table></div></div><ul><li>使用该 ConfigMap 挂载的 Env 不会同步更新</li><li>使用该 ConfigMap 挂载的 Volume 中的数据需要一段时间（实测大概10秒）才能同步更新<br>⚠️ 注意：apps/v1版本的api接口，默认滚动幅度为25%</li></ul><h3 id=secret class=heading-element><span>secret</span>
<a href=#secret class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 id=service-account class=heading-element><span>service Account</span>
<a href=#service-account class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>用来访问 Kubernetes API，由 Kubernetes 自动创建，并且会自动挂载到 Pod 的 <code>/run/secrets/kubernetes.io/serviceaccount</code>
目录中。专门用于集群安全中pod的认证。</p><h4 id=opaque-secret class=heading-element><span>Opaque Secret</span>
<a href=#opaque-secret class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>类似于 configmap，但是 value 字段是编码的value 数据必须是原数据经过 base64 编码以后的结果，secret 在使用的时候，value
会被自动解码</p><table><thead><tr><th>字段</th><th>字段类型</th><th>描述</th></tr></thead><tbody><tr><td>secret.type</td><td>string</td><td>secret类型。有三种类型、service Account、opaque 、dockerconfigjson。本处写opaque</td></tr><tr><td>secret.data</td><td>list</td><td>数据段。格式：key=value；value必须是过 base64 编码以后的结果</td></tr></tbody></table><ul><li><code>kubernetes.io/dockerconfigjson</code>
使用 Kuberctl 命令创建 docker 仓库认证的 secret，命令中有写到。资源清单不在做描述</li></ul><h3 id=volume class=heading-element><span>volume</span>
<a href=#volume class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 id=emptydir空目录 class=heading-element><span>emptyDir（空目录）</span>
<a href=#emptydir%e7%a9%ba%e7%9b%ae%e5%bd%95 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><blockquote><ul><li>当 Pod 被分配给节点时，首先创建 emptyDir 卷，并且只要该 Pod 在该节点上运行，该卷就会存在。正如卷的名字所述，它最初是空的。Pod
中的容器可以读取和写入 emptyDir 卷中的相同文件，尽管该卷可以挂载到每个容器中的相同或不同路径上。当出于任何原因从节点中删除
Pod 时，emptyDir 中的数据将被永久删除</li><li>用法：pod的暂存空间。（存放initC执行结果、容器运行产生元数据-mfsmaster的元数据日志）</li></ul></blockquote><p>⚠️注意：emptyDir跟pod生命周期一致。容器崩溃不会从节点中移除 pod，因此 emptyDir 卷中的数据在容器崩溃时是安全的</p><table><thead><tr><th>字段</th><th>字段类型</th><th>描述</th></tr></thead><tbody><tr><td>pod.spec.volumes</td><td>list</td><td>定义卷</td></tr><tr><td>pod.spec.volumes.name</td><td>string</td><td>卷名</td></tr><tr><td>pod.spec.volumes.emptyDir</td><td>string</td><td>卷类型是emptydir。value值为{ }<br>emptyDir: {}</td></tr><tr><td>pod.sepc.containers.volumeMounts</td><td>list</td><td>挂载一个卷</td></tr><tr><td>pod.sepc.containers.volumeMounts.name</td><td>string</td><td>挂载的卷名</td></tr><tr><td>pod.sepc.containers.volumeMounts.mountPath</td><td>srting</td><td>挂载到哪个目录下</td></tr></tbody></table><h4 id=hostpath class=heading-element><span>hostPath</span>
<a href=#hostpath class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><blockquote><p>hostPath卷将主机节点的文件系统中的文件或目录挂载到集群中，可对主机文件/目录进行判断，判断是否存在，存在是否合理，并做出动作</p></blockquote><table><thead><tr><th>字段</th><th>字段类型</th><th>描述</th></tr></thead><tbody><tr><td>pod.sepc.containers.volumeMounts</td><td>list</td><td>挂载一个卷</td></tr><tr><td>pod.sepc.containers.volumeMounts.name</td><td>string</td><td>挂载的卷名</td></tr><tr><td>pod.sepc.containers.volumeMounts.mountPath</td><td>string</td><td>挂载到哪个目录下</td></tr><tr><td>pod.spec.volumes</td><td>list</td><td>定义卷</td></tr><tr><td>pod.spec.volumes.name</td><td>string</td><td>卷名</td></tr><tr><td>pod.spec.volumes.hostPath</td><td>object</td><td>卷类型为hostpath</td></tr><tr><td>pod.spec.volumes.hostPath.path</td><td>string</td><td>卷的物理机路径（主机上的目录位置）</td></tr><tr><td>pod.spec.volumes.hostPath.type</td><td>string</td><td>key值填hostPath卷的类型。有八个值可选，下方详解。</td></tr></tbody></table><ul><li>hostPath卷类型的vlaue值</li></ul><table><thead><tr><th>值</th><th>行为</th></tr></thead><tbody><tr><td></td><td>空字符串（默认）用于向后兼容，这意味着在挂载 hostPath 卷之前不会执行任何检查。（不检查直接使用）</td></tr><tr><td>DirectoryOrCreate</td><td>如果在给定的路径上没有任何东西存在，那么将根据需要在那里创建一个空目录，权限设置为 0755，与 Kubelet 具有相同的组和所有权**（就是节点所在的Kubelet创建的）。（如果目录不存在则创建一个空目录，存在的是个文件则报错）**</td></tr><tr><td>Directory</td><td>给定的路径下必须存在目录，不存在则报错</td></tr><tr><td>FileOrCreate</td><td>如果在给定的路径上没有任何东西存在，那么会根据需要创建一个空文件，权限设置为 0644，与 Kubelet 具有相同的组和所有权。（如果文件不存在则创建空文件，存在的是个目录则报错）</td></tr><tr><td>File</td><td>给定的路径下必须存在文件，否则报错。</td></tr><tr><td>Socket</td><td>给定的路径下必须存在 UNIX 套接字，否则报错。</td></tr><tr><td>CharDevice</td><td>给定的路径下必须存在字符设备，否则报错。</td></tr><tr><td>BlockDevice</td><td>给定的路径下必须存在块设备，否则报错。</td></tr></tbody></table><h3 id=pvc持久化卷 class=heading-element><span>PVC持久化卷</span>
<a href=#pvc%e6%8c%81%e4%b9%85%e5%8c%96%e5%8d%b7 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 id=pv class=heading-element><span>PV</span>
<a href=#pv class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><blockquote><p>类别是：PersistentVolume<br>PV 也是集群中的资源。 PV 是 Volume 之类的卷插件，但具有独立于使用 PV 的 Pod 的生命周期。可被PVC调用提供给pod</p></blockquote><table><thead><tr><th>字段</th><th>字段类型</th><th>描述</th></tr></thead><tbody><tr><td>spec.capacity</td><td>object</td><td>pv容量</td></tr><tr><td>spec.capacity.storage</td><td>string</td><td>pv的大小。5Gi表示5GB</td></tr><tr><td>spec.volumeMode</td><td>string</td><td>卷模式。写Filesystem即可</td></tr><tr><td>spec.accessModes</td><td>string</td><td>访问模式（读写策略）。三个值可选 ReadWriteOnce——该卷可以被单个节点以读/写模式挂载ReadOnlyMany——该卷可以被多个节点以只读模式挂载ReadWriteMany——该卷可以被多个节点以读/写模式挂载</td></tr><tr><td>spec.persistentVolumeReclaimPolicy</td><td>string</td><td>卷的回收策略，三个值可选<br>Retain（保留）——手动回收（基本都用这个）Recycle（回收）——基本擦除（rm -rf /thevolume/*）<br>Delete（删除）——关联的存储资产，用于动态pv。此策略会将卷直接删除&mdash;-节省成本</td></tr><tr><td>sepc.storageClassName</td><td>string</td><td>定义存储类的类名（是自定义的，严格匹配）</td></tr><tr><td>sepc.nfs</td><td>object</td><td>通过nfs提供底层数据存储</td></tr><tr><td>sepc.nfs.path</td><td>string</td><td>nfs共享的路径</td></tr><tr><td>sepc.nfs.server</td><td>string</td><td>nfs的地址</td></tr></tbody></table><ul><li>Retain（保留）——手动回收（基本都用这个）</li><li>Recycle（回收）——基本擦除（rm -rf /thevolume/*）</li><li>Delete（删除）——关联的存储资产（例如 AWS EBS、GCE PD、Azure Disk 和 OpenStack Cinder 卷）将被删除&mdash;-节省成本</li></ul><h4 id=pvc class=heading-element><span>PVC</span>
<a href=#pvc class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><blockquote><p><code>pvc</code>是用户存储的请求。它与Pod相似。Pod消耗节点资源，PVC消耗PV资源。Pod可以请求特定级别的资源（CPU和内存）。声明可以请求特定的大小和访问模式（例如，可以以读/写一次或只读多次模式挂载）
声明需要在StatefulSet控制器中进行声明<br><code>StatefulSet</code>是为了 解决有状态服务的问题 （对应 Deployments 和 ReplicaSets 是为无状态服务而设计），需要配合无头服务Service使用</p></blockquote><ul><li><p>其特性包括：</p><ul><li>稳定的存储：即 Pod 重新调度后还是能访问到相同的持久化数据，基于 PVC 来实现。<br><code>PV卷的名称为：PodName+PV模板Name。</code></li></ul></li><li><p>稳定的网络标识：即 Pod 重新调度后其 PodName 和 HostName（域名）不变，基于 Headless Service（即没有 Cluster IP 的 Service
）来实现。</p></li><li><p>有序扩容：有序扩展，即 Pod 是有顺序的，在部署或者扩展的时候要依据定义的顺序依次依次进行<br><code>即从 0 到 N-1，在 下一个 Pod 运行之前所有之前的 Pod 必须都是 Running 和 Ready 状态 ，基于 init containers 来实现。 只有当第一个pod就绪以后才会创建第二个pod</code></p></li><li><p>有序的回收：有序删除（即从 N-1 到 0）</p></li><li><p>Service具有以下特点：</p><blockquote><ul><li>没有ClusterIP地址</li><li>kube-proxy不会创建负载均衡转发规则</li><li>Service是否有DNS域名解析取决于还Headless Service是否设置了Label Selector</li></ul></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>nginx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>nginx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>80</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>web</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>clusterIP</span><span class=p>:</span><span class=w> </span><span class=l>None    </span><span class=w> </span><span class=c>#无头svc</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>nginx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>StatefulSet</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>web</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>nginx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>serviceName</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;nginx&#34;</span><span class=w>    </span><span class=c>#必须填写无头服务svc的名字</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class=m>3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>nginx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>nginx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>wangyanglinux/myapp:v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>containerPort</span><span class=p>:</span><span class=w> </span><span class=m>80</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>web</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>volumeMounts</span><span class=p>:</span><span class=w>  </span><span class=c>#卷绑定</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>www     </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>mountPath</span><span class=p>:</span><span class=w> </span><span class=l>/usr/share/nginx/html</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>volumeClaimTemplates</span><span class=p>:</span><span class=w>    </span><span class=c>#pvc的卷声明模板（一个pod对应一个pvc，跟随pod一起创建）</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>www</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>accessModes</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=w> </span><span class=s2>&#34;ReadWriteOnce&#34;</span><span class=w> </span><span class=p>]</span><span class=w>     </span><span class=c>#访问策略</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>storageClassName</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;nfs&#34;</span><span class=w>      </span><span class=c>#使用存储类</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>resources</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>requests</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>storage</span><span class=p>:</span><span class=w> </span><span class=l>1Gi   </span><span class=w> </span><span class=c>#请求资源是1G  回收策略可不写</span></span></span></code></pre></td></tr></table></div></div></li></ul><h3 id=调度器 class=heading-element><span>调度器</span>
<a href=#%e8%b0%83%e5%ba%a6%e5%99%a8 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 id=节点亲和性 class=heading-element><span>节点亲和性</span>
<a href=#%e8%8a%82%e7%82%b9%e4%ba%b2%e5%92%8c%e6%80%a7 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><ul><li>匹配逻辑<blockquote><p>匹配的是节点的标签。只要node符合该标签即为匹配成功</p></blockquote></li></ul><table><thead><tr><th>字段</th><th>字段类型</th><th>描述</th></tr></thead><tbody><tr><td>pod.spec.schedulername</td><td>string</td><td>指定使用调度器（自定义调度器的使用）</td></tr><tr><td>pod.spec.affinity</td><td>object</td><td>pod的亲和性设置</td></tr><tr><td>pod.spec.affinity.nodeAffinity</td><td>object</td><td>节点亲和性设置（硬亲和跟软亲和可在一起）</td></tr><tr><td>pod.spec.affinity.nodeAffinity.requiredDuringSchedulingIgnoredDuringExecution</td><td>object</td><td>节点硬亲和</td></tr><tr><td>硬亲和.nodeSelectorTerms</td><td>list</td><td>节点标签选择器</td></tr><tr><td>硬亲和.nodeSelectorTerms.matchExpressions</td><td></td><td>匹配运算符。下面有多个选项的话，满足任何一个条件就可以了</td></tr><tr><td>硬亲和.nodeSelectorTerms.matchExpressions.matchExpressions</td><td>list</td><td>匹配运算符</td></tr><tr><td>硬亲和.nodeSelectorTerms.matchExpressions.matchExpressions.key</td><td>string</td><td>匹配节点标签的key</td></tr><tr><td>硬亲和.nodeSelectorTerms.matchExpressions.matchExpressions.operator</td><td>string</td><td>使用哪个运算符<br>In：label 的值在某个列表中<br>NotIn：label 的值不在某个列表中<br>Gt：label 的值大于某个值<br>Lt：label 的值小于某个值<br>Exists：某个 label 存在（key是否存在）<br>DoesNotExist：某个 label 不存在（key是否不存在）</td></tr><tr><td>硬亲和.nodeSelectorTerms.matchExpressions.matchExpressions.values</td><td>list</td><td>列表内写匹配的node标签值</td></tr><tr><td>pod.spec.affinity.nodeAffinity.preferredDuringSchedulingIgnoredDuringExecution</td><td>object</td><td>节点软亲和</td></tr><tr><td>软亲和.weight</td><td>string</td><td>软亲和权重范围在 1-100 之间（多个软亲和若产生冲突，选择权重高的）</td></tr><tr><td>软亲和.preference</td><td>object</td><td>节点选择器条目，与权重（weight）相关</td></tr><tr><td>软亲和.preference.matchExpressions</td><td>list</td><td>节点选择器条目，与权重（weight）相关</td></tr><tr><td>软亲和.preference.matchExpressions</td><td>list</td><td>匹配运算符有多个选项的话，则必须同时满足这些条件才能正常调度</td></tr><tr><td>软亲和.preference.matchExpressions.matchExpressions.key</td><td>string</td><td>匹配节点标签的key</td></tr><tr><td>软亲和.preference.matchExpressions…matchExpressions.operator</td><td>string</td><td>使用哪个运算符<br>In：label 的值在某个列表中<br>NotIn：label 的值不在某个列表中<br>Gt：label 的值大于某个值<br>Lt：label 的值小于某个值<br>Exists：某个 label 存在（key是否存在）<br>DoesNotExist：某个 label 不存在（key是否不存在）</td></tr><tr><td>软亲和.preference.matchExpressions.matchExpressions.values</td><td>list</td><td>列表内写匹配的node标签值</td></tr></tbody></table><h4 id=pod亲和性 class=heading-element><span>pod亲和性</span>
<a href=#pod%e4%ba%b2%e5%92%8c%e6%80%a7 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><ul><li><p>匹配逻辑</p><blockquote><p>pod亲和性匹配的是拓扑域，亲和的是拓扑域，反亲和的也是拓扑域。决定跟不跟pod在同一个拓扑域</p></blockquote></li><li><p>首先在整个集群中寻找标签符合匹配条件的pod</p></li><li><p>找到该pod后，根据设置的拓扑域的key匹配其拓扑域的value</p></li><li><p>只要在设置的拓扑域的value与符合标签的pod的拓扑域的value一致，就可以建立pod</p></li></ul><blockquote><p>根据拓扑域匹配新的pod该建立在哪里，只要与上面符合条件的pod在同拓扑域即可。<br>拓扑域：在同一层次就属于同一拓扑域。例如：同一主机、同一机房、同一地区等等<br>pod亲和性不支持Gt、Lt运算符。</p></blockquote><table><thead><tr><th>字段</th><th>字段类型</th><th>描述</th></tr></thead><tbody><tr><td>pod.spec.affinity</td><td>object</td><td>pod的亲和性设置</td></tr><tr><td>pod.spec.affinity.podAffinity</td><td>object</td><td>pod亲和性设置</td></tr><tr><td>pod.spec.affinity.podAntiAffinity</td><td>object</td><td>pod反亲和性设置</td></tr><tr><td>pod亲和性.requiredDuringSchedulingIgnoredDuringExecution</td><td>list</td><td>pod硬亲和策略</td></tr><tr><td>pod亲和性.preferredDuringSchedulingIgnoredDuringExecution</td><td>list</td><td>pod软亲和策略</td></tr></tbody></table><blockquote><p>下方字段通过node亲和性一致</p></blockquote><h3 id=亲和性相关运算符 class=heading-element><span>亲和性相关运算符</span>
<a href=#%e4%ba%b2%e5%92%8c%e6%80%a7%e7%9b%b8%e5%85%b3%e8%bf%90%e7%ae%97%e7%ac%a6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><blockquote><p>键值运算关系</p></blockquote><ul><li>In：label 的值在某个列表中</li><li>NotIn：label 的值不在某个列表中</li><li>Gt：label 的值大于某个值–pod不支持</li><li>Lt：label 的值小于某个值–pod不支持</li><li>Exists：某个 label 存在（key是否存在）</li><li>DoesNotExist：某个 label 不存在（key是否不存在</li></ul><table><thead><tr><th>调度策略</th><th>匹配标签</th><th>操作符</th><th>拓扑域支持</th><th>调度目标</th></tr></thead><tbody><tr><td>nodeAffinity</td><td>主机</td><td>In, NotIn, Exists, DoesNotExist, Gt, Lt</td><td>否</td><td>指定主机</td></tr><tr><td>podAffinity</td><td>POD</td><td>In, NotIn, Exists, DoesNotExist</td><td>是</td><td>POD与指定POD同一拓扑域</td></tr><tr><td>podAnitAffinity</td><td>POD</td><td>In, NotIn, Exists, DoesNotExist</td><td>是</td><td>POD与指定POD不在同一拓扑域</td></tr></tbody></table><ul><li>节点亲和性的前提条件是：<ul><li>在指定拓扑域内，有目标Pod（设置为flag的Pod）。</li><li>如果是硬限制，则目标Pod的标签与matchExpressions中的条件（一个或多个）必须完全匹配。</li><li>如果是软限制，则目标Pod的标签，不是必须的，如果相匹配，还要考虑weight（1~100）关系。</li></ul></li></ul><h4 id=固定节点调度 class=heading-element><span>固定节点调度</span>
<a href=#%e5%9b%ba%e5%ae%9a%e8%8a%82%e7%82%b9%e8%b0%83%e5%ba%a6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><table><thead><tr><th>字段</th><th>字段类型</th><th>描述</th></tr></thead><tbody><tr><td>Pod.spec.nodeName</td><td>string</td><td>固定节点调度，后边跟节点名，可以跳过污点</td></tr><tr><td>Pod.spec.nodeSelector</td><td>string</td><td>匹配节点标签进行调度，不会跳过污点。<br>类似于节点硬亲和，只会在符合匹配的节点上建立。节点不让建立则pending（等待调度）</td></tr></tbody></table><h3 id=污点与容忍 class=heading-element><span>污点与容忍</span>
<a href=#%e6%b1%a1%e7%82%b9%e4%b8%8e%e5%ae%b9%e5%bf%8d class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 id=污点 class=heading-element><span>污点</span>
<a href=#%e6%b1%a1%e7%82%b9 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># 设置污点</span>
</span></span><span class=line><span class=cl>$ kubectl taint node 节点名 <span class=nv>key1</span><span class=o>=</span>value:NoSchedule
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 节点说明中，查找 Taints 字段</span>
</span></span><span class=line><span class=cl>$ kubectl describe node  节点名  
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 去除污点</span>
</span></span><span class=line><span class=cl>$ kubectl taint node 节点名  <span class=nv>key</span><span class=o>=</span>value:NoSchedule-   <span class=c1>#加个  -  号</span></span></span></code></pre></td></tr></table></div></div><h4 id=容忍字段 class=heading-element><span>容忍字段</span>
<a href=#%e5%ae%b9%e5%bf%8d%e5%ad%97%e6%ae%b5 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><table><thead><tr><th>字段</th><th>字段类型</th><th>描述</th></tr></thead><tbody><tr><td>pod.spec.tolerations</td><td>list</td><td>容忍设置</td></tr><tr><td>pod.spec.tolerations.key</td><td>string</td><td>污点的key</td></tr><tr><td>pod.spec.tolerations.operator</td><td>string</td><td>污点运算符<br>“Equal” #运算符是等于</td></tr><tr><td>pod.spec.tolerations.value</td><td>srting</td><td>污点的value</td></tr><tr><td>pod.spec.tolerations.effect</td><td>string</td><td>污点的effect（效果）</td></tr></tbody></table><h3 id=rbac class=heading-element><span>RBAC</span>
<a href=#rbac class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 id=role-and-clusterrole class=heading-element><span>Role and ClusterRole</span>
<a href=#role-and-clusterrole class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><blockquote><p>在 RBAC API 中，Role 表示一组规则权限，权限只会增加(累加权限)，不存在一个资源一开始就有很多权限而通过 RBAC 对其进行减少的操作；Role
可以定义在一个 namespace 中，如果想要跨 namespace 则可以创建 ClusterRole</p></blockquote><ul><li><p>Role资源清单</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Role</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>rbac.authorization.k8s.io/v1beta1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>default  </span><span class=w> </span><span class=c>#必须写，不写就会有个默认值是default</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>pod-reader</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>apiGroups</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w> </span><span class=p>]</span><span class=w> </span><span class=c># &#34;&#34; indicates the core API group    #对哪个接口组版本的资源进行操作，不写就代表核心组：v1 </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>resources</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=w> </span><span class=s2>&#34;pods&#34;</span><span class=w> </span><span class=p>]</span><span class=w>     </span><span class=c>#可进行操作的资源对象</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>verbs</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=w> </span><span class=s2>&#34;get&#34;</span><span class=p>,</span><span class=w> </span><span class=s2>&#34;watch&#34;</span><span class=p>,</span><span class=w> </span><span class=s2>&#34;list&#34;</span><span class=w> </span><span class=p>]</span><span class=w>  </span><span class=c>#对上方资源的操作，一般写all即可，不同资源有不同操作，在开发者手册中有。get：获取这个pod。watch：监控。lsit：列出，加起来就是查看pod的信息</span></span></span></code></pre></td></tr></table></div></div></li><li><p>ClusterRole资源清单</p><blockquote><p>ClusterRole 具有与 Role 相同的权限角色控制能力，不同的是 ClusterRole 是集群级别的，ClusterRole 可以用于:</p><ul><li>集群级别的资源控制( 例如 node 访问权限 )</li><li>非资源型 endpoints( 例如 /health 访问 )</li><li>所有命名空间资源控制(例如 pods )</li></ul></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>ClusterRole</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>rbac.authorization.k8s.io/v1beta1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># &#34;namespace&#34; omitted since ClusterRoles are not namespaced不能写名字空间</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>secret-reader</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>apiGroups</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w> </span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>resources</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=w> </span><span class=s2>&#34;secrets&#34;</span><span class=w> </span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>verbs</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=w> </span><span class=s2>&#34;get&#34;</span><span class=p>,</span><span class=w> </span><span class=s2>&#34;watch&#34;</span><span class=p>,</span><span class=w> </span><span class=s2>&#34;list&#34;</span><span class=w> </span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><p>⚠️ 集群角色不能写名字空间</p></li></ul><h4 id=rolebinding-and-clusterrolebinding class=heading-element><span>RoleBinding and ClusterRoleBinding</span>
<a href=#rolebinding-and-clusterrolebinding class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><blockquote><p>RoleBinding and ClusterRoleBinding是什么？<br>RoloBinding可以将角色中定义的权限授予用户或用户组，RoleBinding 包含一组权限列表(subjects)
权限列表中包含有不同形式的待授予权限资源类型(users, groups, or service accounts)；RoloBinding同样包含对被Bind的Role
引用；RoleBinding 适用于某个命名空间内授权，而 ClusterRoleBinding 适用于集群范围内的授权</p></blockquote><ul><li><p>RoleBinding绑定Role</p><blockquote><p>角色通过角色绑定，绑定给用户（user/group/sa）<br>例如：将 default 命名空间的 pod-reader Role 授予 jane 用户，此后 jane 用户在 default 命名空间中将具有 pod-reader 的权限</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>RoleBinding</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>rbac.authorization.k8s.io/v1beta1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>read-pods</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>default     </span><span class=w> </span><span class=c>#角色所在的名字空间</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>subjects</span><span class=p>:</span><span class=w> </span><span class=c>#绑定给说</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>User       </span><span class=w> </span><span class=c>#绑定给用户</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>jane       </span><span class=w> </span><span class=c>#jane用户</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>apiGroup</span><span class=p>:</span><span class=w> </span><span class=l>rbac.authorization.k8s.io     </span><span class=w> </span><span class=c>#接口组版本</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>roleRef</span><span class=p>:</span><span class=w> </span><span class=c>#角色来源</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Role      </span><span class=w> </span><span class=c>#来源于角色</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>pod-reader  </span><span class=w> </span><span class=c>#来源哪个角色用户</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>apiGroup</span><span class=p>:</span><span class=w> </span><span class=l>rbac.authorization.k8s.io</span></span></span></code></pre></td></tr></table></div></div></li><li><p>RoleBinding绑定ClusterRole</p><blockquote><ul><li>集群角色通过集群角色绑定，绑定给用户（user/group/sa）</li><li>同样可以引用ClusterRole来对当前namespace内用户、用户组或ServiceAccount进行授权，这种操作允许集群管理员在整个集群内定义一些通用的ClusterRole，然后在不同的namespace中使用
<code>RoleBinding</code>来引用</li><li>例如：以下 <code>RoleBinding</code> 引用了一个 ClusterRole，这个 ClusterRole 具有整个集群内对 secrets 的访问权限；但是其授权用户dave只能访问
development 空间中的 secrets(因为 <code>RoleBinding</code> 定义在 development 命名空间)</li></ul></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># This role binding allows &#34;dave&#34; to read secrets in the &#34;development&#34; namespace.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#这个角色绑定允许“dave”读取“dev”命名空间中的信息。</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>RoleBinding         </span><span class=w> </span><span class=c>#资源类型</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>rbac.authorization.k8s.io/v1beta1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>read-secrets</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>dev</span><span class=w> </span><span class=c># 这只授予“dev”名称空间内的权限。必写</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>subjects</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>User</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>dave</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>apiGroup</span><span class=p>:</span><span class=w> </span><span class=l>rbac.authorization.k8s.io</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>roleRef</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>ClusterRole     </span><span class=w> </span><span class=c>#角色来源于集群角色</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>secret-reader</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>apiGroup</span><span class=p>:</span><span class=w> </span><span class=l>rbac.authorization.k8s.io</span></span></span></code></pre></td></tr></table></div></div></li><li><p>ClusterRoleBinding绑定ClusterRole</p><blockquote><ul><li>集群角色通过角色绑定，绑定给用户（user/group/sa）。将集群角色权限限制在角色名字空间下</li><li>使用ClusterRoleBinding可以对整个集群中的所有命名空间资源权限进行授权；以下ClusterRoleBinding样例展示了授权manager组内所有用户在全部命名空间中对secrets进行访问</li></ul></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># This cluster role binding allows anyone in the &#34;manager&#34; group to read secrets in any namespace.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#此集群角色绑定允许“manager”组中的任何人读取任何名称空间中的秘密。</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>ClusterRoleBinding</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>rbac.authorization.k8s.io/v1beta1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>read-secrets-global</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>subjects</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Group</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>manager</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>apiGroup</span><span class=p>:</span><span class=w> </span><span class=l>rbac.authorization.k8s.io</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>roleRef</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>ClusterRole</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>secret-reader</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>apiGroup</span><span class=p>:</span><span class=w> </span><span class=l>rbac.authorization.k8s.io</span></span></span></code></pre></td></tr></table></div></div></li></ul><h4 id=resources子资源 class=heading-element><span>Resources（子资源）</span>
<a href=#resources%e5%ad%90%e8%b5%84%e6%ba%90 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><blockquote><p>Kubernetes 集群内一些资源一般以其名称字符串来表示，这些字符串一般会在 API 的 URL 地址中出现；同时某些资源也会包含子资源，例如
logs 资源就属于 pods 的子资源，API 中 URL 样例如下</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>GET /api/v1/namespaces/{namespace}/pods/{name}/log
</span></span><span class=line><span class=cl>/api/v1/namespaces/default/pods/pod-demo/log</span></span></code></pre></td></tr></table></div></div><blockquote><p>例如：如果要在 RBAC 授权模型中控制这些子资源的访问权限，可以通过 / 分隔符来实现，以下是一个定义 pods 资资源 logs 访问权限的
Role 定义样例</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Role</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>rbac.authorization.k8s.io/v1beta1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>default</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>pod-and-pod-logs-reader</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>apiGroups</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w> </span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>resources</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=w> </span><span class=s2>&#34;pods&#34;</span><span class=p>,</span><span class=w> </span><span class=s2>&#34;pods/log&#34;</span><span class=w> </span><span class=p>]</span><span class=w>  </span><span class=c>#这里添加了两个权限。pods权限，pods/log权限。pods权限包含pods/log权限，这里写pods/log就是给看看写的格式。</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>verbs</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=w> </span><span class=s2>&#34;get&#34;</span><span class=p>,</span><span class=w> </span><span class=s2>&#34;list&#34;</span><span class=w> </span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><h4 id=to-subjects class=heading-element><span>to Subjects</span>
<a href=#to-subjects class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><blockquote><p>权利附着点：user、group、sa<br>权利附着点命名方式<br>RoleBinding 和 ClusterRoleBinding 可以将 Role 绑定到 Subjects；Subjects 可以是 groups、users 或者 service accounts</p></blockquote><ul><li>Subjects 中 Users 使用字符串表示，<ul><li>它可以是一个普通的名字字符串，如 “alice”；</li><li>也可以是 email 格式的邮箱地址，如 “xxx@163.com”；</li><li>甚至是一组字符串形式的数字 ID 。</li><li>但是 Users 的前缀 system: 是系统保留的，集群管理员应该确保普通用户不会使用这个前缀格式</li></ul></li><li>Groups 书写格式与 Users 相同，都为一个字符串，并且没有特定的格式要求；同样 system: 前缀为系统保留</li></ul><h3 id=资源限制 class=heading-element><span>资源限制</span>
<a href=#%e8%b5%84%e6%ba%90%e9%99%90%e5%88%b6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><table><thead><tr><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>spec.container[].resources.requests.cpu</td><td>容器初始要求的CPU数量（Pod运行可能不需要要求的CPU，但必须分配，不能被其他Pod使用）。</td></tr><tr><td>spec.container[].resources.limits.cpu</td><td>容器所能使用的最大CPU数量（单位：500m=0.5）。</td></tr><tr><td>spec.container[].resources.requests.memory</td><td>容器初始要求的内存数量(可以不用，必须分配，不能被其他Pod使用)</td></tr><tr><td>spec.container[].resources.requests.memory</td><td>容器能使用的最大内存数量（单位：Ki,Mi,Gi,Ti,Pi,Ei）</td></tr></tbody></table><table><thead><tr><th>字段</th><th>描述</th></tr></thead><tbody><tr><td>.kind LimitRange</td><td>（指定资源限制对象类型）,注意,需要在metadata中指定命名空间。</td></tr><tr><td>.spec.limits[].default</td><td>设置默认的CPU和memory</td></tr><tr><td>.spec.limits[].defaultRequest</td><td>设置默认的请求值</td></tr><tr><td>.spec.limits[].max</td><td>设置Pod可以请求的（在Pod中设置的）最大资源限制</td></tr><tr><td>.spec.limits[].min</td><td>设置Pod可以请求的（在Pod中设置的）最小资源限制 量（单位：500m=0.5）。</td></tr><tr><td>.spec.container[].resources.requests.memory</td><td>容器初始要求的内存数量(可以不用，必须分配，不能被其他Pod使用)<br>容器能使用的最大内存数量（单位：Ki,Mi,Gi,Ti,Pi,Ei）</td></tr><tr><td>.spec.limits[].maxLimitRequestRatio</td><td>设置默认超售值，Pod可以使用可以超过的的最大资源限制。</td></tr></tbody></table></div><div class=collection-card><div class="collection-title text-secondary">收录于 <a href=/collections/kubernetes/><i class="fa-solid fa-layer-group fa-fw" aria-hidden=true></i> <span>合集・Kubernetes</span></span></a> 1</div><div class=collection-nav></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="更新于 2025-01-07 19:07:33">更新于 2025-01-07&nbsp;</span></div><div class=post-info-license><span><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=/tags/k8s/ class=post-tag title="标签 - K8s">K8s</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/posts/golang-guide/ class=post-nav-item rel=prev title=Golang-Guide><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>Golang-Guide</a></div></div><div id=comments><div id=giscus class=comment><script src=https://giscus.app/client.js data-repo=liangml/liangml.github.io data-repo-id=MDEwOlJlcG9zaXRvcnkxMTkwNDA5MzU: data-category=Announcements data-category-id=DIC_kwDOBxhrp84CjXpD data-mapping=pathname data-strict=0 data-theme=preferred_color_scheme data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-lang=zh-CN data-loading=lazy crossorigin=anonymous async defer></script></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://giscus.app/ rel="external nofollow noopener noreferrer">giscus</a>.</noscript></div></article><aside class=toc id=toc-auto aria-label=目录><h2 class=toc-title>目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class=toc-content id=toc-content-auto></div></aside></main><footer class=footer><div class=footer-container><div class="footer-line powered">由 <a href=https://gohugo.io/ target=_blank rel="external nofollow noopener noreferrer" title="Hugo 0.143.1"><img class=hugo-icon src=/images/hugo.min.svg alt="Hugo logo"> Hugo</a> 强力驱动 | 主题 - <a href=https://github.com/hugo-fixit/FixIt target=_blank rel=external title="FixIt v0.3.16-f66dc32e"><img class=fixit-icon src=/images/fixit.min.svg alt="FixIt logo"> FixIt</a></div><div class="footer-line copyright" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2019 - 2025</span><span class=author itemprop=copyrightHolder>
<a href=/>Leon</a></span><span class="license footer-divider"><a rel:"license external nofollow noopener noreferrer" href:"https://creativecommons.org/licenses/by-nc/4.0/" target:"_blank">CC BY-NC 4.0</a></span></div><div class="footer-line statistics"><span class=site-time title=网站运行中……><i class="fa-solid fa-heartbeat fa-fw animate-icon" aria-hidden=true></i><span class="run-times ms-1">网站运行中……</span></span></div><div class="footer-line visitor"><span id=busuanzi_container_site_uv title=总访客数><i class="fa-regular fa-user fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_site_uv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span><span id=busuanzi_container_site_pv class=footer-divider title=总访问量><i class="fa-regular fa-eye fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_site_pv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label=回到顶部><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class=variant-numeric>0%</span></div><div class="fixed-button view-comments d-none" role=button aria-label=查看评论><i class="fa-solid fa-comment fa-fw" aria-hidden=true></i></div></div><a href=https://github.com/liangml title="在 GitHub 上查看源代码" target=_blank rel="external nofollow" class="github-corner right d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true" width="56" height="56"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><div id=mask></div><div class=reading-progress-bar style=left:0;top:0></div><noscript><div class=noscript-warning>该网站在启用 JavaScript 的情况下效果最佳。</div></noscript></div><link rel=stylesheet href=/lib/lightgallery/css/lightgallery-bundle.min.120f067ebd6f322339e2ccccd7e87e334d7c7ea5b2bd553f325f2ae3c3ae6fe8.css integrity="sha256-Eg8Gfr1vMiM54szM1+h+M018fqWyvVU/Ml8q48Oub+g="><link rel=preload href=/lib/katex/katex.min.7e5db7914b97e596a36c1abb67ccc7f174f8bb71d38c9a88c55b262ed1737f97.css integrity="sha256-fl23kUuX5ZajbBq7Z8zH8XT4u3HTjJqIxVsmLtFzf5c=" as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/katex/katex.min.7e5db7914b97e596a36c1abb67ccc7f174f8bb71d38c9a88c55b262ed1737f97.css integrity="sha256-fl23kUuX5ZajbBq7Z8zH8XT4u3HTjJqIxVsmLtFzf5c="></noscript><script src=/lib/autocomplete/autocomplete.min.ae2da1bd62c6469ee27770ad1cddf2e8296d8a7f6d85b091463e5200c5e320af.js integrity="sha256-ri2hvWLGRp7id3CtHN3y6Cltin9thbCRRj5SAMXjIK8=" defer></script><script src=/lib/fuse/fuse.min.c57339c3fa16b1d69d9a6b46749a8139ef8d4fc9bbfe48144ff897aa7d4222ec.js integrity="sha256-xXM5w/oWsdadmmtGdJqBOe+NT8m7/kgUT/iXqn1CIuw=" defer></script><script src=/lib/lightgallery/lightgallery.min.7de2854e7954105f2b91ff5983749c4e3c7af51e05aae279f8a5d66994a85777.js integrity="sha256-feKFTnlUEF8rkf9Zg3ScTjx69R4FquJ5+KXWaZSoV3c=" defer></script><script src=/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.4fbc3ec1878e90348b71b3594d8ef27c4f10a1a4c6d5e74948d0ee59018fd87c.js integrity="sha256-T7w+wYeOkDSLcbNZTY7yfE8QoaTG1edJSNDuWQGP2Hw=" defer></script><script src=/lib/lightgallery/plugins/zoom/lg-zoom.min.821a2adb8005511c0ad9ef6f395c1b74beacc2da194cd13a4ac43d341246e085.js integrity="sha256-ghoq24AFURwK2e9vOVwbdL6swtoZTNE6SsQ9NBJG4IU=" defer></script><script src=/lib/sharer/sharer.min.ba5171a78670b031914e623431a33a3d73c1ea9897e552ba73bc2c2da7c777b9.js integrity="sha256-ulFxp4ZwsDGRTmI0MaM6PXPB6piX5VK6c7wsLafHd7k=" async defer></script><script src=/lib/katex/katex.min.9f45307c5794ed247a0d095f3a62e52ef2215a67b2327203a7fd919959ae79d1.js integrity="sha256-n0UwfFeU7SR6DQlfOmLlLvIhWmeyMnIDp/2RmVmuedE=" defer></script><script src=/lib/katex/auto-render.min.7b57d427ac6270677daf8d8380ded2cc73336f9149a167b8e1fe0d6ef66604ae.js integrity="sha256-e1fUJ6xicGd9r42DgN7SzHMzb5FJoWe44f4NbvZmBK4=" defer></script><script src=/lib/katex/copy-tex.min.07770af90943a1de1a1010794bc78c6a7346d46d48fb63e35cc76ba76b827604.js integrity="sha256-B3cK+QlDod4aEBB5S8eManNG1G1I+2PjXMdrp2uCdgQ=" defer></script><script src=/lib/katex/mhchem.min.f0ca03df194b8c3d6017ff455db6a0ef98857905663fa311a6cded788b15340b.js integrity="sha256-8MoD3xlLjD1gF/9FXbag75iFeQVmP6MRps3teIsVNAs=" defer></script><script src=/lib/pangu/pangu.min.8feca3e7a71d118d82c2456d1b2cf5f1f3726c51a930627c2711b7192c8edbe2.js integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" defer></script><script src=https://vercount.one/js async defer></script><script>window.config={autoBookmark:!0,code:{copyTitle:"复制到剪贴板",editLockTitle:"锁定可编辑代码块",editUnLockTitle:"解锁可编辑代码块",editable:!0,maxShownLines:50},comment:{enable:!0,expired:!1,giscus:{darkTheme:"dark",lightTheme:"light",origin:"https://giscus.app"}},enablePWA:!0,lightgallery:!0,math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},pangu:{enable:!0,selector:"article"},search:{distance:100,findAllMatches:!1,fuseIndexURL:"/search.json",highlightTag:"em",ignoreFieldNorm:!1,ignoreLocation:!1,isCaseSensitive:!1,location:0,maxResultLength:10,minMatchCharLength:2,noResultsFound:"没有找到结果",snippetLength:30,threshold:.3,type:"fuse",useExtendedSearch:!1},siteTime:"2018-02-06T11:15:22+08:00",version:"v0.3.16-f66dc32e"}</script><script src=/js/theme.min.0daa504da430d5723626cca1801d04ac125316adbe008489bd4ebe37d7bd9a01.js integrity="sha256-DapQTaQw1XI2JsyhgB0ErBJTFq2+AISJvU6+N9e9mgE=" defer></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-TDTX88VL0X",{anonymize_ip:!0})</script><script src="https://www.googletagmanager.com/gtag/js?id=G-TDTX88VL0X" async></script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?0efb33ce4bda317225be7158a8517fd0",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script></body></html>